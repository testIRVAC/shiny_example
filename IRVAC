setwd("~/IRVAC")
#?read.csv
#victime2=read.csv("victime2017-07-05.csv",sep=";")
# library(sas7bdat)
# codeais=read.sas7bdat("Y:/Bases2017/Juin2017/sas/codeais.sas7bdat")
# victime=read.sas7bdat("Y:/Bases2017/Juin2017/sas/victime.sas7bdat")
# fiche=read.sas7bdat("Y:/Bases2017/Juin2017/sas/fiche.sas7bdat")
# lesions=read.sas7bdat("Y:/Bases2017/Juin2017/sas/lesions.sas7bdat")
# accident=read.sas7bdat("Y:/Bases2017/Juin2017/sas/accident.sas7bdat")
library(shiny)
library(gtools)
IRVAC <- function(var) {
  require(shiny)
  require(gtools)
  
  shinyApp(
    shinyUI(fluidPage(
      title = "Application d'interrogation des données du registres",
      sidebarLayout(
        sidebarPanel(
          
          
          fluidRow(
            conditionalPanel(
              paste0('input.dataset === "visualisation"'),
              radioButtons("data", "Table à afficher:",
                           c("accident" = "accident",
                             "lesions" = "lesions",
                             "fiche" = "fiche",
                             "victime" = "victime")),
              actionButton("SélectionButton","voir la Sélection", icon("refresh")),
              actionButton("downloadData", "enregistrer les données de la table active")
              
              
              
            )),
          fluidRow(
            conditionalPanel(
              paste0('input.dataset === "codeais"')),
            conditionalPanel(
              'input.dataset === "codeais"',
              br(),
              h4(" Sélection OR: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4,selectizeInput(
                'NUMERO', 'Sélection des numéros',c("Tout","Aucun", levels(as.factor(codeais$NUMERO))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4,
                     selectizeInput("Rcode","Sélection des R:", c("Tout","Aucun",levels(codeais$R)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("Tcode","Sélection des T:", c("Tout","Aucun",levels(codeais$T)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("Scode","Sélection des S:", c("Tout","Aucun",levels(codeais$S)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("Ncode","Sélection des N:", c("Tout","Aucun",levels(codeais$N)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("AIScode","Sélection des AIS:", c("Tout","Aucun",levels(as.factor(codeais$AIS))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("IIScode","Sélection des IIS:", c("Tout","Aucun",levels(as.factor(codeais$IIS))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("DescrRcode","Sélection des DescrR:", c("Tout","Aucun",levels(codeais$DescrR)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("DescrTcode","Sélection des DescrT:", c("Tout","Aucun",levels(codeais$DescrT)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("DescrScode","Sélection des DescrS:", c("Tout","Aucun",levels(codeais$DescrS)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("DescrNcode","Sélection des DescrN:", c("Tout","Aucun",levels(codeais$DescrN)),selected = "Aucun",multiple=T)
              ))
          ),
          fluidRow(
            conditionalPanel(
              'input.dataset === "codeais"',
              br(),
              h4(" Sélection AND: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4,selectizeInput(
                'NUMERO2', 'Sélection des numéros',c("Tout","Aucun", levels(as.factor(codeais$NUMERO))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4,
                     selectizeInput("Rcode2","Sélection des R:", c("Tout","Aucun",levels(codeais$R)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("Tcode2","Sélection des T:", c("Tout","Aucun",levels(codeais$T)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("Scode2","Sélection des S:", c("Tout","Aucun",levels(codeais$S)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("Ncode2","Sélection des N:", c("Tout","Aucun",levels(codeais$N)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("AIScode2","Sélection des AIS:", c("Tout","Aucun",levels(as.factor(codeais$AIS))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("IIScode2","Sélection des IIS:", c("Tout","Aucun",levels(as.factor(codeais$IIS))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("DescrRcode2","Sélection des DescrR:", c("Tout","Aucun",levels(codeais$DescrR)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("DescrTcode2","Sélection des DescrT:", c("Tout","Aucun",levels(codeais$DescrT)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("DescrScode2","Sélection des DescrS:", c("Tout","Aucun",levels(codeais$DescrS)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              column(4, selectizeInput("DescrNcode2","Sélection des DescrN:", c("Tout","Aucun",levels(codeais$DescrN)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "codeais"'),
              actionButton("SélectionButtoncode","voir la Sélection", icon("refresh"))
            )
          ),
          
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection"',
              checkboxInput("statut1", "Ajouter les satuts 1",value=TRUE),
              checkboxInput("statut2","Ajouter les statuts 2"),
              br(),
              actionButton("SélectionButton","appliquer la Sélection", icon("refresh")),
              br()
            )),
          fluidRow(
            conditionalPanel(
              'input.dataset === "analyse"',
              selectizeInput("choixanalyse","choisir la/les table(s) à analyser ",c("accident","fiche","lesions","victime","victime/accident"),multiple=T),
              column(4,
                     selectInput("choixgraph", "choix du type de graphique",c("Aucun","plot","pie"))
              )
            ),
            conditionalPanel(
              'input.dataset === "analyse"',
              actionButton("tableMAIS","exporter table des MAIS")
              
              
            ),
            conditionalPanel(
              'input.dataset === "analyse"',
              actionButton("tableMIIS","exporter table des MIIS")
              
              
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("accident") != -1',
              h4("Table accident"),
              
              column(4,
                     selectInput("a", "ligne", c("Aucun",colnames(accident)),selected="courly")
              ),
              column(4,
                     selectInput("b", "colonne", c("Aucun",colnames(accident)),selected="reseau")
              ),
              column(4,
                     selectInput("aa", "données pour le plot", colnames(accident))
              ),
              actionButton("downloadDatatab1", "enregistrer la table croisée"),
              checkboxInput("voirsum1", "afficher les sommes du tableau"),
              checkboxInput("retirerNA1", "retirer les colonnes pleines de 0 et les vides"),
              checkboxInput("pourcentageligne1", "afficher les pourcentages lignes"),
              checkboxInput("pourcentagecolonne1", "afficher les pourcentages colonnes")
              
              
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("accident") != -1 && input.choixgraph.indexOf("plot") != -1',
              actionButton("goButton1","voir plot"),
              downloadButton(outputId = "down1", label = "Download the plot")
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("accident") != -1 && input.choixgraph.indexOf("pie") != -1',
              actionButton("pieButton1","voir plot"),
              downloadButton(outputId = "piedown1", label = "Download the plot")
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("fiche") != -1',
              h4("Table fiche"),
              column(4,
                     selectInput("e", "ligne",c("Aucun",colnames(fiche)),selected="n_fiche")
              ),
              column(4,
                     selectInput("f", "colonne",c("Aucun",colnames(fiche)),selected="n_victime")
              ),
              column(4,
                     selectInput("ac", "données pour le plot", colnames(fiche))
              ),
              actionButton("downloadDatatab3", "enregistrer la table croisée"),
              checkboxInput("voirsum3", "afficher les sommes du tableau"),
              checkboxInput("retirerNA3", "retirer les colonnes pleines de 0 et les vides"),
              checkboxInput("pourcentageligne3", "afficher les pourcentages lignes"),
              checkboxInput("pourcentagecolonne3", "afficher les pourcentages colonnes")
              
              
              
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("fiche") != -1 && input.choixgraph.indexOf("plot") != -1',
              actionButton("goButton3","voir plot"),
              downloadButton(outputId = "down3", label = "Download the plot")
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("fiche") != -1 && input.choixgraph.indexOf("pie") != -1',
              actionButton("piebutton3","voir plot"),
              downloadButton(outputId = "piedown3", label = "Download the plot")
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("lesions") != -1',
              h4("Table lésion"),
              column(4,
                     selectInput("c", "ligne", c("Aucun",colnames(lesions)),selected="R")
              ),
              column(4,
                     selectInput("d", "colonne", c("Aucun",colnames(lesions)),selected="T")
              ),
              column(4,
                     selectInput("ab", "données pour le plot", colnames(lesions))
              ),
              actionButton("downloadDatatab2", "enregistrer la table croisée"),
              checkboxInput("voirsum2", "afficher les sommes du tableau"),
              checkboxInput("retirerNA2", "retirer les colonnes pleines de 0 et les vides"),
              checkboxInput("pourcentageligne2", "afficher les pourcentages lignes"),
              checkboxInput("pourcentagecolonne2", "afficher les pourcentages colonnes")
              
              
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("lesions") != -1 && input.choixgraph.indexOf("plot") != -1',
              actionButton("goButton2","voir plot"),
              downloadButton(outputId = "down2", label = "Download the plot")
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("lesions") != -1 && input.choixgraph.indexOf("pie") != -1',
              actionButton("pieButton2","voir plot"),
              downloadButton(outputId = "piedown2", label = "Download the plot")
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("victime") != -1',
              h4("Table victime"),
              column(4,
                     selectInput("g", "ligne", c("Aucun",colnames(victime)),selected="blesse")
              ),
              column(4,
                     selectInput("h", "colonne", c("Aucun",colnames(victime)),selected="sexe")
              ),
              column(4,
                     selectInput("ad", "données pour le plot", colnames(victime))
              ),
              actionButton("downloadDatatab4", "enregistrer la table croisée"),
              checkboxInput("voirsum4", "afficher les sommes du tableau"),
              checkboxInput("retirerNA4", "retirer les colonnes pleines de 0 et les vides"),
              checkboxInput("pourcentageligne4", "afficher les pourcentages lignes"),
              checkboxInput("pourcentagecolonne4", "afficher les pourcentages colonnes")
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("victime") != -1 && input.choixgraph.indexOf("plot") != -1',
              actionButton("goButton4","voir plot"),
              downloadButton(outputId = "down4", label = "Download the plot")
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("victime") != -1 && input.choixgraph.indexOf("pie") != -1',
              actionButton("pieButton4","voir plot"),
              downloadButton(outputId = "piedown4", label = "Download the plot")
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("victime/accident") != -1',
              h4("Table victime/accident"),
              column(4,selectInput("j", "ligne", c("Aucun",names(accident),names(victime)), selected= "sexe")),
              column(4,selectInput("k", "colonne", c("Aucun",names(accident),names(victime)),selected= "nbvicti"))
            ),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("victime/accident") != -1',
              actionButton("downloadDatafusion", "enregistrer la table croisée"),
              checkboxInput("voirsum", "afficher les sommes du tableau"),
              checkboxInput("retirerNA", "retirer les colonnes pleines de 0 et les vides"),
              checkboxInput("pourcentageligne", "afficher les pourcentages lignes"),
              checkboxInput("pourcentagecolonne", "afficher les pourcentages colonnes")
              
            )
          )
        ),
        
        mainPanel(
          
          tabsetPanel(
            id = 'dataset',
            tabPanel('sélection', DT::dataTableOutput('mytable1')),
            tabPanel('visualisation', DT::dataTableOutput('mytable2')),
            tabPanel('analyse', DT::dataTableOutput('mytable3')),
            tabPanel('codeais', DT::dataTableOutput('mytable4'))
            
            
            
          ),
          conditionalPanel(
            'input.dataset === "analyse" && input.choixanalyse.indexOf("accident") != -1',
            h4("Tableau croisé d'accident"),
            br(),
            verbatimTextOutput("crosstable1")
          ),
          
          conditionalPanel(
            'input.dataset === "analyse" && input.choixanalyse.indexOf("fiche") != -1',
            h4("Tableau croisé des fiches"),
            br(),
            verbatimTextOutput("crosstable3")
          ),
          conditionalPanel(
            'input.dataset === "analyse" && input.choixanalyse.indexOf("lesions") != -1',
            h4("Tableau croisé des lésions"),
            br(),
            verbatimTextOutput("crosstable2")
          ),
          conditionalPanel(
            'input.dataset === "analyse" && input.choixanalyse.indexOf("victime") != -1',
            h4("Tableau croisé des victimes"),
            br(),
            verbatimTextOutput("crosstable4")
          ),
          conditionalPanel(
            'input.dataset === "analyse" && input.choixanalyse.indexOf("victime/accident") != -1',
            h4("Tableau croisé des victimes avec les accidents"),
            br(),
            verbatimTextOutput("crosstablefusion")
          ),
          fluidRow(
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("accident") != -1 && input.choixgraph.indexOf("plot") != -1',
              h4("Plot des accidents"),
              plotOutput("plot1")),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("accident") != -1 && input.choixgraph.indexOf("pie") != -1',
              h4("Pie chart d'accidents"),
              plotOutput("pie1")),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("fiche") != -1 && input.choixgraph.indexOf("plot") != -1',
              h4("Plot des fiches"),
              plotOutput("plot3")),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("fiche") != -1 && input.choixgraph.indexOf("pie") != -1',
              h4("Plot des fiches"),
              plotOutput("pie3")),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("lesions") != -1 && input.choixgraph.indexOf("plot") != -1',
              h4("Plot des lesions"),
              plotOutput("plot2")),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("lesions") != -1 && input.choixgraph.indexOf("pie") != -1',
              h4("Pie chart de lesions"),
              plotOutput("pie2")),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("victime") != -1 && input.choixgraph.indexOf("plot") != -1',
              h4("Plot des victimes"),
              plotOutput("plot4")),
            conditionalPanel(
              'input.dataset === "analyse" && input.choixanalyse.indexOf("victime") != -1 && input.choixgraph.indexOf("pie") != -1',
              h4("Pie chart de victime"),
              plotOutput("pie4"))
          ),
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection"',
              br(),
              h2("Table accident"),
              br(),
              column(6,selectizeInput(
                'colonneaccident', 'Sélection des colonnes',c("Tout","Aucun",names(accident)),selected = "Tout", multiple = T)
              )
            )
          ),
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection" && input.colonneaccident != null && input.colonneaccident != "Aucun"',
              br(),
              h4(" Sélection OR: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("reseau") != -1  || input.colonneaccident == "Tout")'),
              column(4,selectizeInput(
                'reseau', 'Sélection des reseaux',c("Tout","Aucun", levels(accident$reseau)),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("courly") != -1  || input.colonneaccident == "Tout")'),
              column(4,selectizeInput(
                'courly', 'Sélection des courly',c("Tout","Aucun", levels(accident$courly)),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("lieu_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4,
                     selectizeInput("lieu","lieu d'accident:", c("Tout","Aucun",levels(as.factor(accident$lieu_acc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("nbvicti") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("nb","Nombre de victime:", c("Tout","Aucun",levels(as.factor(accident$nbvicti))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("jour_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("jour_acc","Sélection des jours:", c("Tout","Aucun",levels(as.factor(accident$jour_acc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("mois_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("mois_acc","Sélection des mois:", c("Tout","Aucun",levels(as.factor(accident$mois_acc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("annee_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("annee_acc","Sélection des années:", c("Tout","Aucun",levels(as.factor(accident$annee_acc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("minute_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("minute_acc","Sélection des minutes:", c("Tout","Aucun",levels(as.factor(accident$minute_acc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("heure_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("heure_acc","Sélection des heures:", c("Tout","Aucun",levels(as.factor(accident$heure_acc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("circonstance") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("circonstance","Sélection des circonstances:", c("Tout","Aucun",levels(accident$circonstance)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("codeinsee") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("codeinsee","Sélection des code INSEE:", c("Tout","Aucun",levels(accident$codeinsee)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("eclairement") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("eclairement","Sélection des éclairement:", c("Tout","Aucun",levels(accident$eclairement)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("Jour_semaine") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("Jour_semaine","Sélection des jours de la semaine:", c("Tout","Aucun",levels(as.factor(accident$Jour_semaine))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("TailleAgglo") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("TailleAgglo","Sélection des taille d'agglomération:", c("Tout","Aucun",levels(as.factor(accident$TailleAgglo))),selected = "Aucun",multiple=T)
              ))
          ),
          
          
          
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection" && input.colonneaccident != null && input.colonneaccident != "Aucun"',
              br(),
              h4(" Sélection AND: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("reseau") != -1  || input.colonneaccident == "Tout")'),
              column(4,selectizeInput(
                'reseau2', 'Sélection des reseaux',c("Tout","Aucun", levels(accident$reseau)),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("courly") != -1  || input.colonneaccident == "Tout")'),
              column(4,selectizeInput(
                'courly2', 'Sélection des courly',c("Tout","Aucun", levels(accident$courly)),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("lieu_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("lieu2","lieu d'accident:", c("Tout","Aucun",levels(as.factor(accident$lieu_acc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("nbvicti") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("nb2","Nombre de victime:", c("Tout","Aucun",levels(as.factor(accident$nbvicti))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("jour_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("jour_acc2","Sélection des jours:", c("Tout","Aucun",levels(as.factor(accident$jour_acc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("mois_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("mois_acc2","Sélection des mois:", c("Tout","Aucun",levels(as.factor(accident$mois_acc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("annee_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("annee_acc2","Sélection des années:", c("Tout","Aucun",levels(as.factor(accident$annee_acc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("minute_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("minute_acc2","Sélection des minutes:", c("Tout","Aucun",levels(as.factor(accident$minute_acc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("heure_acc") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("heure_acc2","Sélection des heures:", c("Tout","Aucun",levels(as.factor(accident$heure_acc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("circonstance") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("circonstance2","Sélection des circonstances:", c("Tout","Aucun",levels(accident$circonstance)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("codeinsee") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("codeinsee2","Sélection des code INSEE:", c("Tout","Aucun",levels(accident$codeinsee)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("eclairement") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("eclairement2","Sélection des éclairement:", c("Tout","Aucun",levels(accident$eclairement)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("Jour_semaine") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("Jour_semaine2","Sélection des jours de la semaine:", c("Tout","Aucun",levels(as.factor(accident$Jour_semaine))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonneaccident != null && input.colonneaccident.indexOf("TailleAgglo") != -1  || input.colonneaccident == "Tout")'),
              column(4, selectizeInput("TailleAgglo2","Sélection des taille d'agglomération:", c("Tout","Aucun",levels(as.factor(accident$TailleAgglo))),selected = "Tout",multiple=T)
              ))
          ),
          
          ##############################################################
          
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection"',
              br(),
              h2("Table lesions"),
              br(),
              column(6,selectInput(
                'colonnelesion', 'Sélection des colonnes',c("Tout","Aucun",names(lesions)),selected = "Tout", multiple = T)
              )
            )
            
          ),
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection" && input.colonnelesion != null && input.colonnelesion != "Aucun"',
              br(),
              h4(" Sélection OR: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("n_victime") != -1  || input.colonnelesion == "Tout")'),
              column(4,selectizeInput(
                'n_victime', 'Sélection des nombres de victimes',c("Tout","Aucun", levels(as.factor(lesions$n_victime))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("n_lesion") != -1  || input.colonnelesion == "Tout")'),
              column(4,selectizeInput(
                'n_lesion', 'Sélection des numéros de lésion',c("Tout","Aucun", levels(as.factor(lesions$n_lesion))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("R") != -1  || input.colonnelesion == "Tout")'),
              column(4,
                     selectizeInput("R","Sélection des R:", c("Tout","Aucun",levels(lesions$R)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("T") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("T","Sélection des T:", c("Tout","Aucun",levels(lesions$T)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("S") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("S","Sélection des S:", c("Tout","Aucun",levels(lesions$S)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("N") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("N","Sélection des N:", c("Tout","Aucun",levels(lesions$N)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("AIS") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("AIS","Sélection des AIS:", c("Tout","Aucun",levels(as.factor(lesions$AIS))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("IIS") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("IIS","Sélection des IIS:", c("Tout","Aucun",levels(as.factor(lesions$IIS))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("lateralite") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("lateralite","Sélection des lateralités:", c("Tout","Aucun",levels(lesions$lateralite)),selected = "Aucun",multiple=T)
              ))
            
          ),
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection" && input.colonnelesion != null && input.colonnelesion != "Aucun"',
              br(),
              h4(" Sélection AND: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("n_victime") != -1  || input.colonnelesion == "Tout")'),
              column(4,selectizeInput(
                'n_victime2', 'Sélection des nombres de victimes',c("Tout","Aucun", levels(as.factor(lesions$n_victime))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("n_lesion") != -1  || input.colonnelesion == "Tout")'),
              column(4,selectizeInput(
                'n_lesion2', 'Sélection des numéros de lésion',c("Tout","Aucun", levels(as.factor(lesions$n_lesion))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("R") != -1  || input.colonnelesion == "Tout")'),
              column(4,
                     selectizeInput("R2","Sélection des R:", c("Tout","Aucun",levels(lesions$R)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("T") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("T2","Sélection des T:", c("Tout","Aucun",levels(lesions$T)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("S") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("S2","Sélection des S:", c("Tout","Aucun",levels(lesions$S)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("N") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("N2","Sélection des N:", c("Tout","Aucun",levels(lesions$N)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("AIS") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("AIS2","Sélection des AIS:", c("Tout","Aucun",levels(as.factor(lesions$AIS))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("IIS") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("IIS2","Sélection des IIS:", c("Tout","Aucun",levels(as.factor(lesions$IIS))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnelesion != null && input.colonnelesion.indexOf("lateralite") != -1  || input.colonnelesion == "Tout")'),
              column(4, selectizeInput("lateralite2","Sélection des lateralités:", c("Tout","Aucun",levels(lesions$lateralite)),selected = "Tout",multiple=T)
              ))
            
          ),
          
          ####################################################################
          
          
          
          
          
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection"',
              br(),
              h2("Table fiche"),
              br(),
              column(6,selectInput(
                'colonnefiche', 'Sélection des colonnes',c("Tout","Aucun",names(fiche)),selected = "Tout", multiple = T)
              )
              
            )
          ),
          
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection" && input.colonnefiche != null && input.colonnefiche != "Aucun"',
              br(),
              h4(" Sélection OR: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("n_victime") != -1  || input.colonnefiche == "Tout")'),
              column(4,selectizeInput(
                'n_victime', 'Sélection des nombres de victimes',c("Tout","Aucun", levels(as.factor(fiche$n_victime))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("n_fiche") != -1  || input.colonnefiche == "Tout")'),
              column(4,selectizeInput(
                'n_fiche', 'Sélection des numéros de fiches ',c("Tout","Aucun", levels(as.factor(fiche$n_fiche))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("service") != -1  || input.colonnefiche == "Tout")'),
              column(4,
                     selectizeInput("service","Sélection des services:", c("Tout","Aucun",levels(fiche$service)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("jour_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("jour_arr","Sélection des jours d'arrêt:", c("Tout","Aucun",levels(as.factor(fiche$jour_arr))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("mois_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("mois_arr","Sélection des mois d'arrêts:", c("Tout","Aucun",levels(as.factor(fiche$mois_arr))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("annee_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("annee_arr","Sélection des années d'arrêt:", c("Tout","Aucun",levels(as.factor(fiche$annee_arr))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("heure_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("heure_arr","Sélection des heures d'arrêt:", c("Tout","Aucun",levels(as.factor(fiche$heure_arr))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("minute_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("minute_arr","Sélection des minutes d'arrêt:", c("Tout","Aucun",levels(as.factor(fiche$minute_arr))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("serviceprec") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("serviceprec","Sélection des services précédents:", c("Tout","Aucun",levels(fiche$serviceprec)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("priseencharge") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("priseencharge","Sélection des prises en charges:", c("Tout","Aucun",levels(fiche$priseencharge)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("devenirversion2") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("devenirversion2","Sélection des devenir version 2:", c("Tout","Aucun",levels(fiche$devenirversion2)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("servicesuiv") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("servicesuiv","Sélection des services suivants:", c("Tout","Aucun",levels(fiche$servicesuiv)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("jour_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("jour_sor","Sélection des jours de sortie:", c("Tout","Aucun",levels(as.factor(fiche$jour_sor))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("mois_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("mois_sor","Sélection des mois de sortie:", c("Tout","Aucun",levels(as.factor(fiche$mois_sor))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("annee_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("annee_sor","Sélection des années de sortie:", c("Tout","Aucun",levels(as.factor(fiche$annee_sor))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("heure_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("heure_sor","Sélection des herues de sortie:", c("Tout","Aucun",levels(as.factor(fiche$heure_sor))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("minute_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("minute_sor","Sélection des minutes de sortie:", c("Tout","Aucun",levels(as.factor(fiche$minute_sor))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("n_fiche_papier") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("n_fiche_papier","Sélection des numéros de fiches papiers:", c("Tout","Aucun",levels(fiche$n_fiche_papier)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("jour_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("jour_dc","Sélection des jours de décès:", c("Tout","Aucun",levels(as.factor(fiche$jour_dc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("mois_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("mois_dc","Sélection des mois de décès:", c("Tout","Aucun",levels(as.factor(fiche$mois_dc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("annee_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("annee_dc","Sélection des années de décès:", c("Tout","Aucun",levels(as.factor(fiche$annee_dc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("heure_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("heure_dc","Sélection des heures de décès:", c("Tout","Aucun",levels(as.factor(fiche$heure_dc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("minute_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("minute_dc","Sélection des minutes de décès:", c("Tout","Aucun",levels(as.factor(fiche$minute_dc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("chronofiche") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("chronofiche","Sélection des chronos fiches:", c("Tout","Aucun",levels(fiche$chronofiche)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("parcours") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("parcours","Sélection des parcours:", c("Tout","Aucun",levels(fiche$parcours)),selected = "Aucun",multiple=T)
              ))
            
          ),
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection" && input.colonnefiche != null && input.colonnefiche != "Aucun"',
              br(),
              h4(" Sélection AND: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("n_victime") != -1  || input.colonnefiche == "Tout")'),
              column(4,selectizeInput(
                'n_victime2', 'Sélection des nombres de victimes',c("Tout","Aucun", levels(as.factor(fiche$n_victime))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("n_fiche") != -1  || input.colonnefiche == "Tout")'),
              column(4,selectizeInput(
                'n_fiche2', 'Sélection des numéros de fiches ',c("Tout","Aucun", levels(as.factor(fiche$n_fiche))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("service") != -1  || input.colonnefiche == "Tout")'),
              column(4,
                     selectizeInput("service2","Sélection des services:", c("Tout","Aucun",levels(fiche$service)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("jour_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("jour_arr2","Sélection des jours d'arrêt:", c("Tout","Aucun",levels(as.factor(fiche$jour_arr))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("mois_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("mois_arr2","Sélection des mois d'arrêts:", c("Tout","Aucun",levels(as.factor(fiche$mois_arr))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("annee_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("annee_arr2","Sélection des années d'arrêt:", c("Tout","Aucun",levels(as.factor(fiche$annee_arr))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("heure_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("heure_arr2","Sélection des heures d'arrêt:", c("Tout","Aucun",levels(as.factor(fiche$heure_arr))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("minute_arr") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("minute_arr2","Sélection des minutes d'arrêt:", c("Tout","Aucun",levels(as.factor(fiche$minute_arr))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("serviceprec") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("serviceprec2","Sélection des services précédents:", c("Tout","Aucun",levels(fiche$serviceprec)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("priseencharge") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("priseencharge2","Sélection des prises en charges:", c("Tout","Aucun",levels(fiche$priseencharge)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("devenirversion2") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("devenirversion22","Sélection des devenir version 2:", c("Tout","Aucun",levels(fiche$devenirversion2)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("servicesuiv") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("servicesuiv2","Sélection des services suivants:", c("Tout","Aucun",levels(fiche$servicesuiv)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("jour_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("jour_sor2","Sélection des jours de sortie:", c("Tout","Aucun",levels(as.factor(fiche$jour_sor))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("mois_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("mois_sor2","Sélection des mois de sortie:", c("Tout","Aucun",levels(as.factor(fiche$mois_sor))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("annee_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("annee_sor2","Sélection des années de sortie:", c("Tout","Aucun",levels(as.factor(fiche$annee_sor))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("heure_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("heure_sor2","Sélection des herues de sortie:", c("Tout","Aucun",levels(as.factor(fiche$heure_sor))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("minute_sor") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("minute_sor2","Sélection des minutes de sortie:", c("Tout","Aucun",levels(as.factor(fiche$minute_sor))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("n_fiche_papier") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("n_fiche_papier2","Sélection des numéros de fiches papiers:", c("Tout","Aucun",levels(fiche$n_fiche_papier)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("jour_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("jour_dc2","Sélection des jours de décès:", c("Tout","Aucun",levels(as.factor(fiche$jour_dc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("mois_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("mois_dc2","Sélection des mois de décès:", c("Tout","Aucun",levels(as.factor(fiche$mois_dc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("annee_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("annee_dc2","Sélection des années de décès:", c("Tout","Aucun",levels(as.factor(fiche$annee_dc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("heure_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("heure_dc2","Sélection des heures de décès:", c("Tout","Aucun",levels(as.factor(fiche$heure_dc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("minute_dc") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("minute_dc2","Sélection des minutes de décès:", c("Tout","Aucun",levels(as.factor(fiche$minute_dc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("chronofiche") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("chronofiche2","Sélection des chronos fiches:", c("Tout","Aucun",levels(fiche$chronofiche)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnefiche != null && input.colonnefiche.indexOf("parcours") != -1  || input.colonnefiche == "Tout")'),
              column(4, selectizeInput("parcours2","Sélection des parcours:", c("Tout","Aucun",levels(fiche$parcours)),selected = "Tout",multiple=T)
              ))
          ),
          
          ##########################################################################################################################################################
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection"',
              br(),
              h2("Table victime"),
              br(),
              column(6,selectInput(
                'colonnevictime', 'Sélection des colonnes',c("Tout","Aucun",names(victime)),selected = "Tout", multiple = T)
              )
              
            )
          ),
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection" && input.colonnevictime != null && input.colonnevictime != "Aucun"',
              br(),
              h4(" Sélection OR: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("n_victime") != -1  || input.colonnevictime == "Tout")'),
              column(4 ,selectizeInput('num_victime', 'Sélection des numéros de victimes',c("Tout","Aucun", levels(as.factor(victime$n_victime))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("n_individu") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('n_individu', 'Sélection des individus',c("Tout","Aucun", levels(as.factor(victime$n_individu))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("jour_nais") != -1  || input.colonnevictime == "Tout")'),
              column(4,
                     selectizeInput("jour_nais","Sélection des jours de naissances:", c("Tout","Aucun",levels(as.factor(victime$jour_nais))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("mois_nais") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("mois_nais","Sélection des mois de naissances:", c("Tout","Aucun",levels(as.factor(victime$mois_nais))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("annee_nais") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("annee_nais","Sélection des années de naissances:", c("Tout","Aucun",levels(as.factor(victime$annee_nais))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("mois_acc") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("mois_acc","Sélection des mois d'accidents:", c("Tout","Aucun",levels(as.factor(victime$mois_acc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("sexe") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("sexe","Sélection du sexe:", c("Tout","Aucun",levels(victime$sexe)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("dep_res") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("dep_res","Sélection des réseaux:", c("Tout","Aucun",levels(victime$dep_res)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("blesse") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("blesse","Sélection des blessures:", c("Tout","Aucun",levels(victime$blesse)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("veh_elec") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("veh_elec","Véhicules élèctriques:", c("Tout","Aucun",levels(victime$veh_elec)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("antagoniste") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("antagoniste","Sélection des antagonistes:", c("Tout","Aucun",levels(victime$antagoniste)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("antagoniste2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("antagoniste2","Sélection des antagonistes 2:", c("Tout","Aucun",levels(victime$antagoniste2)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("airbag") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("airbag","airbag:", c("Tout","Aucun",levels(victime$airbag)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("ceinture") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("ceinture","ceinture:", c("Tout","Aucun",levels(victime$ceinture)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("memo") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("memo","Sélection des memo:", c("Tout","Aucun",levels(victime$memo)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("info_pomp") != -1  || input.colonnevictime == "Tout")'),
              column(4,selectizeInput('info_pomp', 'Sélection des information des pompes funebres',c("Tout","Aucun", levels(as.factor(victime$info_pomp))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("info_patient") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('info_patient', 'Sélection des informations sur les patients',c("Tout","Aucun", levels(as.factor(victime$info_patient))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("info_journal") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("info_journal","Sélection des informations des journeaux:", c("Tout","Aucun",levels(as.factor(victime$info_journal))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("info_police") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("info_police","Sélection des informations de la polices:", c("Tout","Aucun",levels(as.factor(victime$info_police))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("conducteur") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("conducteur","Sélection du types de conducteur:", c("Tout","Aucun",levels(victime$conducteur)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("portcasque") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("portcasque","Port du casque:", c("Tout","Aucun",levels(victime$portcasque)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("dispositifenfant") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("dispositifenfant","dispositif enfant:", c("Tout","Aucun",levels(victime$dispositifenfant)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("femmeenceinte") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("femmeenceinte","femme enceinte:", c("Tout","Aucun",levels(victime$femmeenceinte)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("poids") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("poids","Sélection des poids:", c("Tout","Aucun",levels(victime$poids)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("taille") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("taille","Sélection des tailles:", c("Tout","Aucun",levels(victime$taille)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("acctravail") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("acctravail","accident de travail:", c("Tout","Aucun",levels(victime$acctravail)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("autvictime") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("autvictime","autvictime:", c("Tout","Aucun",levels(victime$autvictime)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("nbautvictime") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("nbautvictime","Sélection du nombre d'autvictime:", c("Tout","Aucun",levels(as.factor(victime$nbautvictime))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("desclesionsnew") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("desclesionsnew","desclesionsnew:", c("Tout","Aucun",levels(victime$desclesionsnew)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("pathoInterc") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('pathoInterc', 'Sélection des pathologies Interc',c("Tout","Aucun", levels(victime$pathoInterc)),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("autopsie") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('autopsie', 'autopsie',c("Tout","Aucun", levels(victime$autopsie)),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("leveedecorps") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("leveedecorps","leve de corp:", c("Tout","Aucun",levels(victime$leveedecorps)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("decho") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("decho","decho:", c("Tout","Aucun",levels(victime$decho)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("samu") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("samu","SAMU:", c("Tout","Aucun",levels(victime$samu)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("dcimm") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("dcimm","décès immédiat:", c("Tout","Aucun",levels(victime$dcimm)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("tetra") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("tetra","tétraplégie:", c("Tout","Aucun",levels(victime$tetra)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("para") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("para","paraplégie:", c("Tout","Aucun",levels(victime$para)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("comles") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("comles","comles:", c("Tout","Aucun",levels(victime$comles)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("id_victi") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("id_victi","Id de victimes:", c("Tout","Aucun",levels(victime$id_victi)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("tas") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("tas","tas:", c("Tout","Aucun",levels(as.factor(victime$tas))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("tad") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("tad","tad:", c("Tout","Aucun",levels(as.factor(victime$tad))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("gcs") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("gcs","gcs:", c("Tout","Aucun",levels(as.factor(victime$gcs))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("fc") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("fc","fc:", c("Tout","Aucun",levels(as.factor(victime$fc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("satO2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('satO2', 'stat02',c("Tout","Aucun", levels(as.factor(victime$satO2))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("glycemie") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('glycemie', 'Sélection du niveau de glycémie',c("Tout","Aucun", levels(as.factor(victime$glycemie))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("hemocue") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("hemocue","hemocue:", c("Tout","Aucun",levels(as.factor(victime$hemocue))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("temperature") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("temperature","Sélection des température:", c("Tout","Aucun",levels(as.factor(victime$temperature))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("commentphysio") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("commentphysio","Sélection des commentaire physiologique:", c("Tout","Aucun",levels(victime$commentphysio)),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS","Sélection des MAIS:", c("Tout","Aucun",levels(as.factor(victime$MAIS))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("dc") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("dc","Sélection des décès:", c("Tout","Aucun",levels(as.factor(victime$dc))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("statut") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("statut","Sélection des statuts:", c("Tout","Aucun",levels(as.factor(victime$statut))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("RetourDom") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("RetourDom","Retour à domicile:", c("Tout","Aucun",levels(as.factor(victime$RetourDom))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("DevenirComplet") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("DevenirComplet","Devenir Complet du patient:", c("Tout","Aucun",levels(as.factor(victime$DevenirComplet))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("typeFich") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("typeFich","Sélection des type de fiche:", c("Tout","Aucun",levels(as.factor(victime$typeFich))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS","Sélection des MIIS:", c("Tout","Aucun",levels(as.factor(victime$MIIS))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("nblesion") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("nblesion","Sélection des nombres de lésions:", c("Tout","Aucun",levels(as.factor(victime$nblesion))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS1") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS1","Sélection des MAIS1:", c("Tout","Aucun",levels(as.factor(victime$MAIS1))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS1") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('MIIS1', 'Sélection des MIIS1:',c("Tout","Aucun", levels(as.factor(victime$MIIS1))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R1") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('R1', 'Sélection des R1',c("Tout","Aucun", levels(as.factor(victime$R1))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS2","Sélection des MAIS2:", c("Tout","Aucun",levels(as.factor(victime$MAIS2))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS2","Sélection des MIIS1:", c("Tout","Aucun",levels(as.factor(victime$MIIS2))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("Rdeux","Sélection des R2:", c("Tout","Aucun",levels(as.factor(victime$R2))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS3") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS3","Sélection des MAIS3:", c("Tout","Aucun",levels(as.factor(victime$MAIS3))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS3") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS3","Sélection des MIIS3:", c("Tout","Aucun",levels(as.factor(victime$MIIS3))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R3") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R3","Sélection des R3:", c("Tout","Aucun",levels(as.factor(victime$R3))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS4") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS4","Sélection des MAIS4:", c("Tout","Aucun",levels(as.factor(victime$MAIS4))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS4") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS4","Sélection des MIIS4:", c("Tout","Aucun",levels(as.factor(victime$MIIS4))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R4") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R4","Sélection des R4:", c("Tout","Aucun",levels(as.factor(victime$R4))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS5") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS5","Sélection des MAIS5:", c("Tout","Aucun",levels(as.factor(victime$MAIS5))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS5") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS5","Sélection des MIIS5:", c("Tout","Aucun",levels(as.factor(victime$MIIS5))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R5") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R5","Sélection des R5:", c("Tout","Aucun",levels(as.factor(victime$R5))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS6") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('MAIS6', 'Sélection des MAIS6',c("Tout","Aucun", levels(as.factor(victime$MAIS6))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS6") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('MIIS6', 'Sélection des MIIS6',c("Tout","Aucun", levels(as.factor(victime$MIIS6))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R6") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R6","Sélection des R6:", c("Tout","Aucun",levels(as.factor(victime$R6))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS7") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS7","Sélection des MAIS7:", c("Tout","Aucun",levels(as.factor(victime$MAIS7))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS7") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS7","Sélection des MIIS7:", c("Tout","Aucun",levels(as.factor(victime$MIIS7))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R7") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R7","Sélection des R7:", c("Tout","Aucun",levels(as.factor(victime$R7))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS8") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS8","Sélection des MAIS8:", c("Tout","Aucun",levels(as.factor(victime$MAIS8))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS8") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS8","Sélection des MIIS8:", c("Tout","Aucun",levels(as.factor(victime$MIIS8))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R8") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R8","Sélection des R8:", c("Tout","Aucun",levels(as.factor(victime$R8))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS9","Sélection des MAIS9:", c("Tout","Aucun",levels(as.factor(victime$MAIS9))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS9","Sélection des MIIS9:", c("Tout","Aucun",levels(as.factor(victime$MIIS9))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R9","Sélection des R9:", c("Tout","Aucun",levels(as.factor(victime$R9))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("gravMAIS") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("gravMAIS","Sélection des gravMAIS:", c("Tout","Aucun",levels(as.factor(victime$gravMAIS))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("gravMIIS") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("gravMIIS","Sélection des gravMIIS:", c("Tout","Aucun",levels(as.factor(victime$gravMIIS))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf","Sélection des maisf:", c("Tout","Aucun",levels(as.factor(victime$maisf))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf1") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('maisf1', 'Sélection des maisf1:',c("Tout","Aucun", levels(as.factor(victime$maisf1))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('maisf2', 'Sélection des maisf2:',c("Tout","Aucun", levels(as.factor(victime$maisf2))),selected = "Aucun", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf3") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf3","Sélection des maisf3:", c("Tout","Aucun",levels(as.factor(victime$maisf3))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf4") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf4","Sélection des maisf4:", c("Tout","Aucun",levels(as.factor(victime$maisf4))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf5") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf5","Sélection des maisf5:", c("Tout","Aucun",levels(as.factor(victime$maisf5))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf6") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf6","Sélection des maisf6:", c("Tout","Aucun",levels(as.factor(victime$maisf6))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf7") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf7","Sélection des maisf7:", c("Tout","Aucun",levels(as.factor(victime$maisf7))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf8") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf8","Sélection des maisf8:", c("Tout","Aucun",levels(as.factor(victime$maisf8))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf9","Sélection des maisf9:", c("Tout","Aucun",levels(as.factor(victime$maisf9))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AgeA") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AgeA","Sélection des AgeA:", c("Tout","Aucun",levels(as.factor(victime$AgeA))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AgeArron") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AgeArron","Sélection des AgeArron:", c("Tout","Aucun",levels(as.factor(victime$AgeArron))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AgeJ") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AgeJ","Sélection des AgeJ:", c("Tout","Aucun",levels(as.factor(victime$AgeJ))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AgeRev") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AgeRev","Sélection des AgeRev:", c("Tout","Aucun",levels(as.factor(victime$AgeRev))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("iss") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("iss","Sélection des iss:", c("Tout","Aucun",levels(as.factor(victime$iss))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("niss") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("niss","Sélection des niss:", c("Tout","Aucun",levels(as.factor(victime$niss))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AISCode9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AISCode9","Sélection des AISCode9:", c("Tout","Aucun",levels(as.factor(victime$AISCode9))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("nbhosp") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("nbhosp","Sélection des nbhosp:", c("Tout","Aucun",levels(as.factor(victime$nbhosp))),selected = "Aucun",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("rBaac") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("rBaac","Sélection des rBaac:", c("Tout","Aucun",levels(as.factor(victime$rBaac))),selected = "Aucun",multiple=T)
              ))
            
            
          ),
          
          fluidRow(
            conditionalPanel(
              'input.dataset === "sélection" && input.colonnevictime != null && input.colonnevictime != "Aucun"',
              br(),
              h4(" Sélection AND: "),
              br()
            ),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("n_victime") != -1  || input.colonnevictime == "Tout")'),
              column(4 ,selectizeInput('num_victime2','Sélection des numéros de victimes',c("Tout","Aucun", levels(as.factor(victime$n_victime))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("n_individu") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('n_individu2','Sélection des individus',c("Tout","Aucun", levels(as.factor(victime$n_individu))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("jour_nais") != -1  || input.colonnevictime == "Tout")'),
              column(4,
                     selectizeInput("jour_nais2","Sélection des jours de naissances:", c("Tout","Aucun",levels(as.factor(victime$jour_nais))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("mois_nais") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("mois_nais2","Sélection des mois de naissances:", c("Tout","Aucun",levels(as.factor(victime$mois_nais))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("annee_nais") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("annee_nais2","Sélection des années de naissances:", c("Tout","Aucun",levels(as.factor(victime$annee_nais))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("mois_acc") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("mois_acc2","Sélection des mois d'accidents:", c("Tout","Aucun",levels(as.factor(victime$mois_acc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("sexe") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("sexe2","Sélection du sexe:", c("Tout","Aucun",levels(victime$sexe)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("dep_res") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("dep_res2","Sélection des réseaux:", c("Tout","Aucun",levels(victime$dep_res)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("blesse") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("blesse2","Sélection des blessures:", c("Tout","Aucun",levels(victime$blesse)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("veh_elec") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("veh_elec2","Véhicules élèctriques:", c("Tout","Aucun",levels(victime$veh_elec)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("antagoniste") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("antagonistedeux","Sélection des antagonistes:", c("Tout","Aucun",levels(victime$antagoniste)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("antagoniste2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("antagoniste22","Sélection des antagonistes 2:", c("Tout","Aucun",levels(victime$antagoniste2)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("airbag") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("airbag2","airbag:", c("Tout","Aucun",levels(victime$airbag)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("ceinture") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("ceinture2","ceinture:", c("Tout","Aucun",levels(victime$ceinture)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("memo") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("memo2","Sélection des memo:", c("Tout","Aucun",levels(victime$memo)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("info_pomp") != -1  || input.colonnevictime == "Tout")'),
              column(4,selectizeInput('info_pomp2','Sélection des information des pompes funebres',c("Tout","Aucun", levels(as.factor(victime$info_pomp))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("info_patient") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('info_patient2','Sélection des informations sur les patients',c("Tout","Aucun", levels(as.factor(victime$info_patient))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("info_journal") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("info_journal2","Sélection des informations des journeaux:", c("Tout","Aucun",levels(as.factor(victime$info_journal))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("info_police") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("info_police2","Sélection des informations de la polices:", c("Tout","Aucun",levels(as.factor(victime$info_police))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("conducteur") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("conducteur2","Sélection du types de conducteur:", c("Tout","Aucun",levels(victime$conducteur)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("portcasque") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("portcasque2","Port du casque:", c("Tout","Aucun",levels(victime$portcasque)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("dispositifenfant") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("dispositifenfant2","dispositif enfant:", c("Tout","Aucun",levels(victime$dispositifenfant)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("femmeenceinte") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("femmeenceinte2","femme enceinte:", c("Tout","Aucun",levels(victime$femmeenceinte)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("poids") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("poids2","Sélection des poids:", c("Tout","Aucun",levels(victime$poids)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("taille") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("taille2","Sélection des tailles:", c("Tout","Aucun",levels(victime$taille)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("acctravail") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("acctravail2","accident de travail:", c("Tout","Aucun",levels(victime$acctravail)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("autvictime") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("autvictime2","autvictime:", c("Tout","Aucun",levels(victime$autvictime)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("nbautvictime") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("nbautvictime2","Sélection du nombre d'autvictime:", c("Tout","Aucun",levels(as.factor(victime$nbautvictime))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("desclesionsnew") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("desclesionsnew2","desclesionsnew:", c("Tout","Aucun",levels(victime$desclesionsnew)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("pathoInterc") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('pathoInterc2','Sélection des pathologies Interc',c("Tout","Aucun", levels(victime$pathoInterc)),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("autopsie") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('autopsie2','autopsie',c("Tout","Aucun", levels(victime$autopsie)),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("leveedecorps") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("leveedecorps2","leve de corp:", c("Tout","Aucun",levels(victime$leveedecorps)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("decho") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("decho2","decho:", c("Tout","Aucun",levels(victime$decho)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("samu") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("samu2","SAMU:", c("Tout","Aucun",levels(victime$samu)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("dcimm") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("dcimm2","décès immédiat:", c("Tout","Aucun",levels(victime$dcimm)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("tetra") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("tetra2","tétraplégie:", c("Tout","Aucun",levels(victime$tetra)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("para") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("para2","paraplégie:", c("Tout","Aucun",levels(victime$para)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("comles") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("comles2","comles:", c("Tout","Aucun",levels(victime$comles)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("id_victi") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("id_victi2","Id de victimes:", c("Tout","Aucun",levels(victime$id_victi)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("tas") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("tas2","tas:", c("Tout","Aucun",levels(as.factor(victime$tas))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("tad") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("tad2","tad:", c("Tout","Aucun",levels(as.factor(victime$tad))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("gcs") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("gcs2","gcs:", c("Tout","Aucun",levels(as.factor(victime$gcs))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("fc") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("fc2","fc:", c("Tout","Aucun",levels(as.factor(victime$fc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("satO2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('satO22','stat02',c("Tout","Aucun", levels(as.factor(victime$satO2))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("glycemie") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('glycemie2','Sélection du niveau de glycémie',c("Tout","Aucun", levels(as.factor(victime$glycemie))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("hemocue") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("hemocue2","hemocue:", c("Tout","Aucun",levels(as.factor(victime$hemocue))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("temperature") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("temperature2","Sélection des température:", c("Tout","Aucun",levels(as.factor(victime$temperature))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("commentphysio") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("commentphysio2","Sélection des commentaire physiologique:", c("Tout","Aucun",levels(victime$commentphysio)),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAISdeux","Sélection des MAIS:", c("Tout","Aucun",levels(as.factor(victime$MAIS))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("dc") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("dc2","Sélection des décès:", c("Tout","Aucun",levels(as.factor(victime$dc))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("statut") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("statutdeux","Sélection des statuts:", c("Tout","Aucun",levels(as.factor(victime$statut))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("RetourDom") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("RetourDom2","Retour à domicile:", c("Tout","Aucun",levels(as.factor(victime$RetourDom))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("DevenirComplet") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("DevenirComplet2","Devenir Complet du patient:", c("Tout","Aucun",levels(as.factor(victime$DevenirComplet))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("typeFich") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("typeFich2","Sélection des type de fiche:", c("Tout","Aucun",levels(as.factor(victime$typeFich))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIISdeux","Sélection des MIIS:", c("Tout","Aucun",levels(as.factor(victime$MIIS))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("nblesion") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("nblesion2","Sélection des nombres de lésions:", c("Tout","Aucun",levels(as.factor(victime$nblesion))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS1") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS12","Sélection des MAIS1:", c("Tout","Aucun",levels(as.factor(victime$MAIS1))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS1") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('MIIS12','Sélection des MIIS1:',c("Tout","Aucun", levels(as.factor(victime$MIIS1))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R1") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('R12','Sélection des R1',c("Tout","Aucun", levels(as.factor(victime$R1))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS22","Sélection des MAIS2:", c("Tout","Aucun",levels(as.factor(victime$MAIS2))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS22","Sélection des MIIS1:", c("Tout","Aucun",levels(as.factor(victime$MIIS2))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("Rdeux2","Sélection des R2:", c("Tout","Aucun",levels(as.factor(victime$R2))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS3") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS32","Sélection des MAIS3:", c("Tout","Aucun",levels(as.factor(victime$MAIS3))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS3") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS32","Sélection des MIIS3:", c("Tout","Aucun",levels(as.factor(victime$MIIS3))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R3") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R32","Sélection des R3:", c("Tout","Aucun",levels(as.factor(victime$R3))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS4") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS42","Sélection des MAIS4:", c("Tout","Aucun",levels(as.factor(victime$MAIS4))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS4") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS42","Sélection des MIIS4:", c("Tout","Aucun",levels(as.factor(victime$MIIS4))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R4") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R42","Sélection des R4:", c("Tout","Aucun",levels(as.factor(victime$R4))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS5") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS52","Sélection des MAIS5:", c("Tout","Aucun",levels(as.factor(victime$MAIS5))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS5") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS52","Sélection des MIIS5:", c("Tout","Aucun",levels(as.factor(victime$MIIS5))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R5") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R52","Sélection des R5:", c("Tout","Aucun",levels(as.factor(victime$R5))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS6") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('MAIS62','Sélection des MAIS6',c("Tout","Aucun", levels(as.factor(victime$MAIS6))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS6") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('MIIS62','Sélection des MIIS6',c("Tout","Aucun", levels(as.factor(victime$MIIS6))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R6") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R62","Sélection des R6:", c("Tout","Aucun",levels(as.factor(victime$R6))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS7") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS72","Sélection des MAIS7:", c("Tout","Aucun",levels(as.factor(victime$MAIS7))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS7") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS72","Sélection des MIIS7:", c("Tout","Aucun",levels(as.factor(victime$MIIS7))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R7") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R72","Sélection des R7:", c("Tout","Aucun",levels(as.factor(victime$R7))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS8") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS82","Sélection des MAIS8:", c("Tout","Aucun",levels(as.factor(victime$MAIS8))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS8") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS82","Sélection des MIIS8:", c("Tout","Aucun",levels(as.factor(victime$MIIS8))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R8") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R82","Sélection des R8:", c("Tout","Aucun",levels(as.factor(victime$R8))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MAIS9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MAIS92","Sélection des MAIS9:", c("Tout","Aucun",levels(as.factor(victime$MAIS9))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("MIIS9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("MIIS92","Sélection des MIIS9:", c("Tout","Aucun",levels(as.factor(victime$MIIS9))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("R9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("R92","Sélection des R9:", c("Tout","Aucun",levels(as.factor(victime$R9))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("gravMAIS") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("gravMAIS2","Sélection des gravMAIS:", c("Tout","Aucun",levels(as.factor(victime$gravMAIS))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("gravMIIS") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("gravMIIS2","Sélection des gravMIIS:", c("Tout","Aucun",levels(as.factor(victime$gravMIIS))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisfdeux","Sélection des maisf:", c("Tout","Aucun",levels(as.factor(victime$maisf))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf1") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('maisf12','Sélection des maisf1:',c("Tout","Aucun", levels(as.factor(victime$maisf1))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf2") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput('maisf22','Sélection des maisf2:',c("Tout","Aucun", levels(as.factor(victime$maisf2))),selected = "Tout", multiple = T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf3") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf32","Sélection des maisf3:", c("Tout","Aucun",levels(as.factor(victime$maisf3))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf4") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf42","Sélection des maisf4:", c("Tout","Aucun",levels(as.factor(victime$maisf4))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf5") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf52","Sélection des maisf5:", c("Tout","Aucun",levels(as.factor(victime$maisf5))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf6") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf62","Sélection des maisf6:", c("Tout","Aucun",levels(as.factor(victime$maisf6))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf7") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf72","Sélection des maisf7:", c("Tout","Aucun",levels(as.factor(victime$maisf7))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf8") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf82","Sélection des maisf8:", c("Tout","Aucun",levels(as.factor(victime$maisf8))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("maisf9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("maisf92","Sélection des maisf9:", c("Tout","Aucun",levels(as.factor(victime$maisf9))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AgeA") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AgeA2","Sélection des AgeA:", c("Tout","Aucun",levels(as.factor(victime$AgeA))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AgeArron") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AgeArron2","Sélection des AgeArron:", c("Tout","Aucun",levels(as.factor(victime$AgeArron))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AgeJ") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AgeJ2","Sélection des AgeJ:", c("Tout","Aucun",levels(as.factor(victime$AgeJ))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AgeRev") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AgeRev2","Sélection des AgeRev:", c("Tout","Aucun",levels(as.factor(victime$AgeRev))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("iss") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("iss2","Sélection des iss:", c("Tout","Aucun",levels(as.factor(victime$iss))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("niss") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("niss2","Sélection des niss:", c("Tout","Aucun",levels(as.factor(victime$niss))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("AISCode9") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("AISCode92","Sélection des AISCode9:", c("Tout","Aucun",levels(as.factor(victime$AISCode9))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("nbhosp") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("nbhosp2","Sélection des nbhosp:", c("Tout","Aucun",levels(as.factor(victime$nbhosp))),selected = "Tout",multiple=T)
              )),
            conditionalPanel(
              paste0('input.dataset === "sélection" &&  (input.colonnevictime != null && input.colonnevictime.indexOf("rBaac") != -1  || input.colonnevictime == "Tout")'),
              column(4, selectizeInput("rBaac2","Sélection des rBaac:", c("Tout","Aucun",levels(as.factor(victime$rBaac))),selected = "Tout",multiple=T)
              ))
            
          )
          
          
        )
        
        
      )
    )),
    #################################SERVER###############################################
    shinyServer(function(input, output) {
      shiny.maxRequestSize=10*1024^2
      
      output$mytable2 <- DT::renderDataTable(DT::datatable({
        
        data1 <- accident
        data2 <- accident
        
        input$SélectionButton
        isolate({
          if (!("Tout"%in% input$reseau)   & !("Tout" %in% input$courly) & !("Tout" %in% input$nb) & !("Tout" %in% input$lieu)
              & !("Tout" %in% input$jour_acc) & !("Tout" %in% input$minute_acc) & !("Tout" %in% input$heure_acc) & !("Tout" %in% input$circonstanc) 
              & !("Tout" %in% input$codeinsee ) & !("Tout" %in% input$eclairement ) & !("Tout" %in% input$mois_acc ) & !("Tout" %in% input$Jour_semaine ) & !("Tout" %in% input$TailleAgglo ) & !("Tout" %in% input$annee_acc ))
            
          {
            data1 <- data1[data1$reseau %in% input$reseau | data1$courly %in% input$courly 
                           | data1$lieu_acc  %in% input$lieu | data1$nbvicti %in% input$nb
                           | data1$jour_acc %in% input$jour_acc | data1$mois_acc %in% input$mois_acc 
                           | data1$minute_acc %in% input$minute_acc | data1$heure_acc %in% input$heure_acc 
                           | data1$circonstance %in% input$circonstance | data1$codeinsee %in% input$codeinsee
                           | data1$eclairement %in% input$eclairement | data1$Jour_semaine %in% input$Jour_semaine 
                           | data1$TailleAgglo %in% input$TailleAgglo | data1$annee_acc %in% input$annee_acc ,]
            
            
          }
          
          if (!("Tout" %in% input$reseau2 ))
            data2 <- data2[data2$reseau %in% input$reseau2 ,]
          
          if (!("Tout" %in% input$courly2 ))
            data2 <- data2[data2$courly  %in% input$courly2 ,]
          
          if (!("Tout" %in% input$lieu2 ))
            data2 <- data2[data2$lieu_acc %in% input$lieu2 ,]
          
          if (!("Tout" %in% input$nb2  ))
            data2 <- data2[data2$nbvicti %in% input$nb2 ,]
          
          if (!("Tout" %in% input$jour_acc2 ))
            data2 <- data2[data2$jour_acc %in% input$jour_acc2 ,]
          
          if (!("Tout" %in% input$minute_acc2 ))
            data2 <- data2[data2$minute_acc %in% input$minute_acc2 ,]
          
          if (!("Tout" %in% input$heure_acc2 ))
            data2 <- data2[data2$heure_acc %in% input$heure_acc2 ,]
          
          if (!("Tout" %in% input$circonstance2 ))
            data2 <- data2[data2$circonstance %in% input$circonstance2 ,]
          
          if (!("Tout" %in% input$codeinsee2 ))
            data2 <- data2[data2$codeinsee %in% input$codeinsee2 ,]
          
          if (!("Tout" %in% input$eclairement2 ))
            data2 <- data2[data2$eclairement %in% input$eclairement2 ,]
          
          if (!("Tout" %in% input$mois_acc2 ))
            data2 <- data2[data2$mois_acc %in% input$mois_acc2 ,]
          
          if (!("Tout" %in% input$Jour_semaine2 ))
            data2 <- data2[data2$Jour_semaine %in% input$Jour_semaine2 ,]
          
          if (!("Tout" %in% input$TailleAgglo2 ))
            data2 <- data2[data2$TailleAgglo %in% input$TailleAgglo2 ,]
          
          if (!("Tout" %in% input$annee_acc2 ))
            data2 <- data2[data2$annee_acc %in% input$annee_acc2 ,]
          
          
          if ("Tout" %in% input$reseau2  & "Tout" %in% input$courly2  & "Tout" %in% input$nb2  & "Tout" %in% input$lieu2 
              & "Tout" %in% input$jour_acc2  & "Tout" %in% input$minute_acc2  & "Tout" %in% input$heure_acc2  &"Tout" %in% input$circonstance2 
              & "Tout" %in% input$codeinsee2  & "Tout" %in% input$eclairement2  & "Tout" %in% input$mois_acc2  & "Tout" %in% input$Jour_semaine2  & "Tout" %in% input$TailleAgglo2  & "Tout" %in% input$annee_acc2  ){
            
            if("Aucun" %in% input$reseau  & "Aucun" %in% input$courly  & "Aucun" %in% input$nb  & "Aucun" %in% input$lieu 
               & "Aucun" %in% input$jour_acc  & "Aucun" %in% input$minute_acc  & "Aucun" %in% input$heure_acc  &"Aucun" %in% input$circonstance 
               & "Aucun" %in% input$codeinsee  & "Aucun" %in% input$eclairement  & "Aucun" %in% input$mois_acc  & "Aucun" %in% input$Jour_semaine  & "Aucun" %in% input$TailleAgglo  & "Aucun" %in% input$annee_acc  )
              DATA1=accident
            
            else(DATA1=data1)
          }
          
          else(DATA1=merge(data1,data2,by=names(accident),all=T))
        })
        DATA3 <- fiche
        data3 <- fiche
        data4 <- fiche
        
        
        input$SélectionButton
        isolate({
          if (  !("Tout" %in% input$n_victime )
                & !("Tout" %in% input$n_fiche ) & !("Tout" %in% input$service ) & !("Tout" %in% input$jour_arr )
                & !("Tout" %in% input$mois_arr ) & !("Tout" %in% input$annee_arr ) & !("Tout" %in% input$heure_arr ) &!("Tout" %in% input$minute_arr )
                & !("Tout" %in% input$serviceprec ) & !("Tout" %in% input$priseencharge ) & !("Tout" %in% input$devenirversion2 ) & !("Tout" %in% input$servicesuiv ) & !("Tout" %in% input$jour_sor ) & !("Tout" %in% input$mois_sor )
                & !("Tout" %in% input$annee_sor ) & !("Tout" %in% input$heure_sor ) & !("Tout" %in% input$minute_sor ) & !("Tout" %in% input$n_fiche_papier ) & !("Tout" %in% input$jour_dc ) & !("Tout" %in% input$mois_dc )
                & !("Tout" %in% input$annee_dc ) & !("Tout" %in% input$heure_dc ) & !("Tout" %in% input$minute_dc ) & !("Tout" %in% input$chronofiche ) & !("Tout" %in% input$parcours )
          )
            
          {
            data3 <- data3[data3$n_victime %in% input$n_victime
                           | data3$n_fiche %in% input$n_fiche
                           | data3$service  %in% input$service | data3$jour_arr %in% input$jour_arr
                           | data3$mois_arr %in% input$mois_arr | data3$annee_arr %in% input$annee_arr
                           | data3$heure_arr %in% input$heure_arr | data3$minute_arr %in% input$minute_arr
                           | data3$serviceprec %in% input$serviceprec | data3$priseencharge %in% input$priseencharge
                           | data3$devenirversion2 %in% input$devenirversion2 | data3$servicesuiv %in% input$servicesuiv
                           | data3$jour_sor %in% input$jour_sor | data3$mois_sor %in% input$mois_sor
                           | data3$annee_sor  %in% input$annee_sor | data3$heure_sor %in% input$heure_sor
                           | data3$minute_sor %in% input$minute_sor | data3$n_fiche_papier %in% input$n_fiche_papier
                           | data3$jour_dc %in% input$jour_dc | data3$mois_dc %in% input$mois_dc
                           | data3$annee_dc %in% input$annee_dc | data3$heure_dc %in% input$heure_dc
                           | data3$minute_dc %in% input$minute_dc | data3$chronofiche %in% input$chronofiche
                           | data3$parcours %in% input$parcours
                           ,]
          }
          
          if (!("Tout" %in% input$n_fiche2 ))
            data4 <- data4[data4$n_fiche %in% input$n_fiche2,]
          
          if (!("Tout" %in% input$n_victime2 ))
            data4 <- data4[data4$n_victime %in% input$n_victime2,]
          
          if (!("Tout" %in% input$service2 ))
            data4 <- data4[data4$service  %in% input$service2,]
          
          if (!("Tout" %in% input$jour_arr2 ))
            data4 <- data4[data4$jour_arr %in% input$jour_arr2,]
          
          if (!("Tout" %in% input$mois_arr2 ))
            data4 <- data4[data4$mois_arr %in% input$mois_arr2,]
          
          if (!("Tout" %in% input$annee_arr2 ))
            data4 <- data4[data4$annee_arr %in% input$annee_arr2,]
          
          if (!("Tout" %in% input$heure_arr2 ))
            data4 <- data4[data4$heure_arr %in% input$heure_arr2,]
          
          if (!("Tout" %in% input$minute_arr2 ))
            data4 <- data4[data4$minute_arr %in% input$minute_arr2,]
          
          if (!("Tout" %in% input$serviceprec2 ))
            data4 <- data4[data4$serviceprec %in% input$serviceprec2,]
          
          if (!("Tout" %in% input$priseencharge2 ))
            data4 <- data4[data4$priseencharge %in% input$priseencharge2,]
          
          if (!("Tout" %in% input$devenirversion22 ))
            data4 <- data4[data4$devenirversion2 %in% input$devenirversion22,]
          
          if (!("Tout" %in% input$servicesuiv2 ))
            data4 <- data4[data4$servicesuiv %in% input$servicesuiv2,]
          
          if (!("Tout" %in% input$jour_sor2 ))
            data4 <- data4[data4$jour_sor %in% input$jour_sor2,]
          
          if (!("Tout" %in% input$mois_sor2 ))
            data4 <- data4[data4$mois_sor %in% input$mois_sor2,]
          
          if (!("Tout" %in% input$annee_sor2 ))
            data4 <- data4[data4$annee_sor %in% input$annee_sor2,]
          
          if (!("Tout" %in% input$heure_sor2 ))
            data4 <- data4[data4$heure_sor %in% input$heure_sor2,]
          
          if (!("Tout" %in% input$minute_sor2 ))
            data4 <- data4[data4$minute_sor  %in% input$minute_sor2,]
          
          if (!("Tout" %in% input$n_fiche_papier2 ))
            data4 <- data4[data4$n_fiche_papier %in% input$n_fiche_papier2,]
          
          if (!("Tout" %in% input$jour_dc2 ))
            data4 <- data4[data4$jour_dc %in% input$jour_dc2,]
          
          if (!("Tout" %in% input$mois_dc2 ))
            data4 <- data4[data4$mois_dc %in% input$mois_dc2,]
          
          if (!("Tout" %in% input$annee_dc2 ))
            data4 <- data4[data4$annee_dc %in% input$annee_dc2,]
          
          if (!("Tout" %in% input$heure_dc2 ))
            data4 <- data4[data4$heure_dc %in% input$heure_dc2,]
          
          if (!("Tout" %in% input$minute_dc2 ))
            data4 <- data4[data4$minute_dc %in% input$minute_dc2,]
          
          if (!("Tout" %in% input$chronofiche2 ))
            data4 <- data4[data4$chronofiche %in% input$chronofiche2,]
          
          if (!("Tout" %in% input$parcours2 ))
            data4 <- data4[data4$parcours %in% input$parcours2,]
          
          
          
          
          if (  "Tout" %in% input$n_victime2  
                & "Tout" %in% input$n_fiche2   & "Tout" %in% input$service2   & "Tout" %in% input$jour_arr2  
                & "Tout" %in% input$mois_arr2   & "Tout" %in% input$annee_arr2   & "Tout" %in% input$heure_arr2   &"Tout" %in% input$minute_arr2  
                & "Tout" %in% input$serviceprec2   & "Tout" %in% input$priseencharge2   & "Tout" %in% input$devenirversion22   & "Tout" %in% input$servicesuiv2   & "Tout" %in% input$jour_sor2   & "Tout" %in% input$mois_sor2  
                & "Tout" %in% input$annee_sor2   & "Tout" %in% input$heure_sor2   & "Tout" %in% input$minute_sor2   & "Tout" %in% input$n_fiche_papier2   & "Tout" %in% input$jour_dc2   & "Tout" %in% input$mois_dc2  
                & "Tout" %in% input$annee_dc2   & "Tout" %in% input$heure_dc2   & "Tout" %in% input$minute_dc2   & "Tout" %in% input$chronofiche2   & "Tout" %in% input$parcours2  
          ){
            
            if (  "Aucun" %in% input$n_victime  
                  & "Aucun" %in% input$n_fiche   & "Aucun" %in% input$service   & "Aucun" %in% input$jour_arr  
                  & "Aucun" %in% input$mois_arr   & "Aucun" %in% input$annee_arr   & "Aucun" %in% input$heure_arr   &"Aucun" %in% input$minute_arr  
                  & "Aucun" %in% input$serviceprec   & "Aucun" %in% input$priseencharge   & "Aucun" %in% input$devenirversion2   & "Aucun" %in% input$servicesuiv   & "Aucun" %in% input$jour_sor   & "Aucun" %in% input$mois_sor  
                  & "Aucun" %in% input$annee_sor   & "Aucun" %in% input$heure_sor   & "Aucun" %in% input$minute_sor   & "Aucun" %in% input$n_fiche_papier   & "Aucun" %in% input$jour_dc   & "Aucun" %in% input$mois_dc  
                  & "Aucun" %in% input$annee_dc   & "Aucun" %in% input$heure_dc   & "Aucun" %in% input$minute_dc   & "Aucun" %in% input$chronofiche   & "Aucun" %in% input$parcours  
            )
              DATA3=fiche
            
            else(DATA3=data3)
          }
          
          else(DATA3=merge(data3,data4,by=names(fiche),all=T))
        })
        
        
        data5 <- lesions
        data6 <- lesions
        
        
        input$SélectionButton
        isolate({
          if (!("Tout" %in% input$n_victime )
              & !("Tout" %in% input$n_lesion )
              & !("Tout" %in% input$R )
              & !("Tout" %in% input$T )
              & !("Tout" %in% input$S )
              & !("Tout" %in% input$N )
              & !("Tout" %in% input$AIS )
              & !("Tout" %in% input$IIS )
              & !("Tout" %in% input$lateralite )
              
          )
            
          {
            data5 <- data5[
              data5$n_victime %in% input$n_victime
              | data5$n_lesion %in% input$n_lesion
              | data5$R  %in% input$R
              | data5$T %in% input$T
              | data5$S %in% input$S
              | data5$N %in% input$N
              | data5$AIS %in% input$AIS
              | data5$IIS %in% input$IIS
              | data5$lateralite %in% input$lateralite
              
              ,]
            
            
          }
          if (!("Tout" %in% input$n_victime2 ))
            data6 <- data6[data6$n_victime %in% input$n_victime2 ,]
          
          if (!("Tout" %in% input$n_lesion2 ))
            data6 <- data6[data6$n_lesion  %in% input$n_lesion2 ,]
          
          if (!("Tout" %in% input$R2 ))
            data6 <- data6[data6$R %in% input$R2 ,]
          
          if (!("Tout" %in% input$T2 ))
            data6 <- data6[data6$T %in% input$T2 ,]
          
          if (!("Tout" %in% input$S2 ))
            data6 <- data6[data6$S %in% input$S2 ,]
          
          if (!("Tout" %in% input$N2 ))
            data6 <- data6[data6$N %in% input$N2 ,]
          
          if (!("Tout" %in% input$AIS2 ))
            data6 <- data6[data6$AIS %in% input$AIS2 ,]
          
          if (!("Tout" %in% input$IIS2 ))
            data6 <- data6[data6$IIS %in% input$IIS2 ,]
          
          if (!("Tout" %in% input$lateralite2 ))
            data6 <- data6[data6$lateralite %in% input$lateralite2 ,]
          
          
          
          
          
          
          if ("Tout" %in% input$n_victime2  & "Tout" %in% input$n_lesion2 & "Tout" %in% input$R2 &
              "Tout" %in% input$T2  &"Tout" %in% input$S2  &
              "Tout" %in% input$N2 &"Tout" %in% input$AIS2 & "Tout" %in% input$IIS2  & "Tout" %in% input$lateralite2  ) {
            
            if ("Aucun" %in% input$n_victime  & "Aucun" %in% input$n_lesion & "Aucun" %in% input$R &
                "Aucun" %in% input$T  &"Aucun" %in% input$S  &
                "Aucun" %in% input$N &"Aucun" %in% input$AIS & "Aucun" %in% input$IIS  & "Aucun" %in% input$lateralite  )
              DATA2=lesions
            
            else(DATA2=data5)
          }
          
          else(DATA2=merge(data5,data6,by=names(lesions),all=T))
        })
        
        
        DATA4 <- victime
        data7 <- victime
        data8 <- victime
        
        
        input$SélectionButton
        isolate({
          if (!("Tout" %in% input$num_victime )        & !("Tout" %in% input$n_individu )
              & !("Tout" %in% input$jour_nais )        & !("Tout" %in% input$mois_nais )
              & !("Tout" %in% input$annee_nais )       & !("Tout" %in% input$sexe )
              & !("Tout" %in% input$dep_res )          & !("Tout" %in% input$blesse )
              & !("Tout" %in% input$veh_elec )         & !("Tout" %in% input$antagoniste )
              & !("Tout" %in% input$antagoniste2 )     & !("Tout" %in% input$airbag )
              & !("Tout" %in% input$ceinture )         & !("Tout" %in% input$memo )
              & !("Tout" %in% input$info_pomp )        & !("Tout" %in% input$info_patient )
              & !("Tout" %in% input$info_journal )     & !("Tout" %in% input$info_police )
              & !("Tout" %in% input$conducteur )       & !("Tout" %in% input$portcasque )
              & !("Tout" %in% input$dispositifenfant ) & !("Tout" %in% input$femmeenceinte )
              & !("Tout" %in% input$poids )            & !("Tout" %in% input$taille )
              & !("Tout" %in% input$acctravail )       & !("Tout" %in% input$autvictime )
              & !("Tout" %in% input$nbautvictime )     & !("Tout" %in% input$desclesionsnew )
              & !("Tout" %in% input$pathoInterc )      & !("Tout" %in% input$autopsie )
              & !("Tout" %in% input$leveedecorps )     & !("Tout" %in% input$decho )
              & !("Tout" %in% input$samu )             & !("Tout" %in% input$dcimm )
              & !("Tout" %in% input$tetra )            & !("Tout" %in% input$para )
              & !("Tout" %in% input$comles )           & !("Tout" %in% input$id_victi )
              & !("Tout" %in% input$tas )              & !("Tout" %in% input$tad )
              & !("Tout" %in% input$gcs )              & !("Tout" %in% input$fc )
              & !("Tout" %in% input$satO2 )            & !("Tout" %in% input$glycemie )
              & !("Tout" %in% input$hemocue )          & !("Tout" %in% input$temperature )
              & !("Tout" %in% input$commentphysio )    & !("Tout" %in% input$MAIS )
              & !("Tout" %in% input$dc )               & !("Tout" %in% input$statut )
              & !("Tout" %in% input$RetourDom )        & !("Tout" %in% input$DevenirComplet )
              & !("Tout" %in% input$typeFich )         & !("Tout" %in% input$MIIS )
              & !("Tout" %in% input$nblesion )         & !("Tout" %in% input$MAIS1 )
              & !("Tout" %in% input$MIIS1 )            & !("Tout" %in% input$R1 )
              & !("Tout" %in% input$MAIS2 )            & !("Tout" %in% input$MIIS2 )
              & !("Tout" %in% input$Rdeux )
              & !("Tout" %in% input$MAIS3 )
              & !("Tout" %in% input$MIIS3 )            & !("Tout" %in% input$R3 )
              & !("Tout" %in% input$MAIS4 )            & !("Tout" %in% input$MIIS4 )
              & !("Tout" %in% input$R4 )               & !("Tout" %in% input$MAIS5 )
              & !("Tout" %in% input$MIIS5 )            & !("Tout" %in% input$R5 )
              & !("Tout" %in% input$MAIS6 )            & !("Tout" %in% input$MIIS6 )
              & !("Tout" %in% input$R6 )               & !("Tout" %in% input$MAIS7 )
              & !("Tout" %in% input$MIIS7 )            & !("Tout" %in% input$R7 )
              & !("Tout" %in% input$MAIS8 )            & !("Tout" %in% input$MIIS8 )
              & !("Tout" %in% input$R8 )               & !("Tout" %in% input$MAIS9 )
              & !("Tout" %in% input$MIIS9 )            & !("Tout" %in% input$R9 )
              & !("Tout" %in% input$gravMAIS )         & !("Tout" %in% input$gravMIIS )
              & !("Tout" %in% input$maisf )            & !("Tout" %in% input$maisf1 )
              & !("Tout" %in% input$maisf2 )           & !("Tout" %in% input$maisf3 )
              & !("Tout" %in% input$maisf4 )           & !("Tout" %in% input$maisf5 )
              & !("Tout" %in% input$maisf6 )           & !("Tout" %in% input$maisf7 )
              & !("Tout" %in% input$maisf8 )           & !("Tout" %in% input$maisf9 )
              & !("Tout" %in% input$AgeA )             & !("Tout" %in% input$AgeArron )
              & !("Tout" %in% input$AgeJ )             & !("Tout" %in% input$AgeRev )
              & !("Tout" %in% input$iss )              & !("Tout" %in% input$niss )
              & !("Tout" %in% input$AISCode9 )         & !("Tout" %in% input$nbhosp )
              & !("Tout" %in% input$rBaac )
          )
          
          {
            data7 <- data7[data7$n_victime %in%input$num_victime               | data7$n_individu %in% input$n_individu
                           | data7$jour_nais %in% input$jour_nais              | data7$mois_nais %in% input$mois_nais
                           | data7$annee_nais %in% input$annee_nais            | data7$sexe %in% input$sexe
                           | data7$dep_res %in% input$dep_res                  | data7$blesse %in% input$blesse
                           | data7$veh_elec %in% input$veh_elec                | data7$antagoniste %in%  input$antagoniste
                           | data7$antagoniste2 %in% input$antagoniste2        | data7$airbag %in% input$airbag
                           | data7$ceinture %in% input$ceinture                | data7$memo %in% input$memo
                           | data7$info_pomp %in% input$info_pomp              | data7$info_patient %in% input$info_patient
                           | data7$info_journal %in% input$info_journal        | data7$info_police %in% input$info_police
                           | data7$conducteur %in% input$conducteur            | data7$portcasque %in% input$portcasque
                           | data7$dispositifenfant %in% input$dispositifenfant| data7$femmeenceinte %in% input$femmeenceinte
                           | data7$poids %in% input$poids                      | data7$taille %in% input$taille
                           | data7$acctravail %in% input$acctravail            | data7$autvictime %in% input$autvictime
                           | data7$nbautvictime %in% input$nbautvictime        | data7$desclesionsnew %in% input$desclesionsnew
                           | data7$pathoInterc %in% input$pathoInterc          | data7$autopsie %in% input$autopsie
                           | data7$leveedecorps %in% input$leveedecorps        | data7$decho %in% input$decho
                           | data7$samu %in% input$samu                        | data7$dcimm %in% input$dcimm
                           | data7$tetra %in% input$tetra                      | data7$para %in% input$para
                           | data7$comles %in% input$comles                    | data7$id_victi %in% input$id_victi
                           | data7$tas %in% input$tas                          | data7$tad %in% input$tad
                           | data7$gcs %in% input$gcs                          | data7$fc %in% input$fc
                           | data7$satO2 %in% input$satO2                      | data7$glycemie %in% input$glycemie
                           | data7$hemocue %in% input$hemocue                  | data7$temperature %in% input$temperature
                           | data7$commentphysio %in% input$commentphysio      | data7$MAIS %in% input$MAIS
                           | data7$dc %in% input$dc                            | data7$statut %in% input$statut
                           | data7$RetourDom %in% input$RetourDom              | data7$DevenirComplet %in% input$DevenirComplet
                           | data7$typeFich %in% input$typeFich
                           | data7$MIIS %in% input$MIIS                        | data7$nblesion %in% input$nblesion
                           | data7$MAIS1 %in% input$MAIS1                      | data7$MIIS1 %in%  input$MIIS1
                           | data7$R1 %in% input$R1                            | data7$MAIS2 %in% input$MAIS2
                           | data7$MIIS2 %in% input$MIIS2                      | data7$R2 %in% input$Rdeux
                           | data7$MAIS3 %in% input$MAIS3                      | data7$MIIS3 %in% input$MIIS3
                           | data7$R3 %in% input$R3                            | data7$MAIS4 %in% input$MAIS4
                           | data7$MIIS4 %in% input$MIIS4                      | data7$R4 %in% input$R4
                           | data7$MAIS5 %in% input$MAIS5                      | data7$MIIS5 %in% input$MIIS5
                           | data7$R5 %in% input$R5                            | data7$MAIS6 %in% input$MAIS6
                           | data7$MIIS6 %in% input$MIIS6                      | data7$R6 %in% input$R6
                           | data7$MAIS7 %in% input$MAIS7                      | data7$MIIS7 %in% input$MIIS7
                           | data7$R7 %in% input$R7                            | data7$MAIS8 %in% input$MAIS8
                           | data7$MIIS8 %in% input$MIIS8                      | data7$R8 %in% input$R8
                           | data7$MAIS9 %in% input$MAIS9                      | data7$MIIS9 %in% input$MIIS9
                           | data7$R9 %in% input$R9                            | data7$gravMAIS %in% input$gravMAIS
                           | data7$gravMIIS %in% input$gravMIIS                | data7$maisf %in% input$maisf
                           | data7$maisf1 %in% input$maisf1                    | data7$maisf2 %in% input$maisf2
                           | data7$maisf3 %in% input$maisf3                    | data7$maisf4 %in% input$maisf4
                           | data7$maisf5 %in% input$maisf5                    | data7$maisf6 %in% input$maisf6
                           | data7$maisf7 %in% input$maisf7                    | data7$maisf8 %in% input$maisf8
                           | data7$maisf9 %in% input$maisf9                    | data7$AgeA %in% input$AgeA
                           | data7$AgeArron %in% input$AgeArron                | data7$AgeJ %in% input$AgeJ
                           | data7$AgeRev %in% input$AgeRev                    | data7$iss %in% input$iss
                           | data7$niss %in% input$niss                        | data7$AISCode9 %in% input$AISCode9
                           | data7$nbhosp %in% input$nbhosp                    | data7$rBaac %in% input$rBaac
                           
                           ,]
            
            
          }
          if (!("Tout" %in% input$num_victime2 ))
            data8 <- data8[data8$n_victime %in% input$num_victime2 ,]
          if ( !("Tout" %in% input$n_individu2 ))
            data8 <- data8[data8$n_individu %in% input$n_individu2 ,]
          if ( !("Tout" %in% input$jour_nais2 ))
            data8 <- data8[data8$jour_nais %in% input$jour_nais2 ,]
          if ( !("Tout" %in% input$mois_nais2 ))
            data8 <- data8[data8$mois_nais %in% input$mois_nais2 ,]
          if ( !("Tout" %in% input$annee_nais2 ))
            data8 <- data8[data8$annee_nais %in% input$annee_nais2 ,]
          if ( !("Tout" %in% input$sexe2 ))
            data8 <- data8[data8$sexe %in% input$sexe2 ,]
          if ( !("Tout" %in% input$dep_res2 ))
            data8 <- data8[data8$dep_res %in% input$dep_res2 ,]
          if ( !("Tout" %in% input$blesse2 ))
            data8 <- data8[data8$blesse %in% input$blesse2 ,]
          if ( !("Tout" %in% input$veh_elec2 ))
            data8 <- data8[data8$veh_elec %in% input$veh_elec2 ,]
          if ( !("Tout" %in% input$antagonistedeux ))
            data8 <- data8[data8$antagoniste %in% input$antagonistedeux ,]
          if ( !("Tout" %in% input$antagoniste22 ))
            data8 <- data8[data8$antagoniste2 %in% input$antagoniste22 ,]
          if ( !("Tout" %in% input$airbag2 ))
            data8 <- data8[data8$airbag %in% input$airbag2 ,]
          if ( !("Tout" %in% input$ceinture2 ))
            data8 <- data8[data8$ceinture %in% input$ceinture2 ,]
          if ( !("Tout" %in% input$memo2 ))
            data8 <- data8[data8$memo %in% input$memo2 ,]
          if ( !("Tout" %in% input$info_pomp2 ))
            data8 <- data8[data8$info_pomp %in% input$info_pomp2 ,]
          if ( !("Tout" %in% input$info_patient2 ))
            data8 <- data8[data8$info_patient %in% input$info_patient2 ,]
          if ( !("Tout" %in% input$info_journal2 ))
            data8 <- data8[data8$info_journal %in% input$info_journal2 ,]
          if ( !("Tout" %in% input$info_police2 ))
            data8 <- data8[data8$info_police %in% input$info_police2 ,]
          if ( !("Tout" %in% input$conducteur2 ))
            data8 <- data8[data8$conducteur %in% input$conducteur2 ,]
          if ( !("Tout" %in% input$portcasque2 ))
            data8 <- data8[data8$portcasque %in% input$portcasque2 ,]
          if ( !("Tout" %in% input$dispositifenfant2 ))
            data8 <- data8[data8$dispositifenfant %in% input$dispositifenfant2 ,]
          if ( !("Tout" %in% input$femmeenceinte2 ))
            data8 <- data8[data8$femmeenceinte %in% input$femmeenceinte2 ,]
          if ( !("Tout" %in% input$poids2 ))
            data8 <- data8[data8$poids %in% input$poids2 ,]
          if ( !("Tout" %in% input$taille2 ))
            data8 <- data8[data8$taille %in% input$taille2 ,]
          if ( !("Tout" %in% input$acctravail2 ))
            data8 <- data8[data8$acctravail %in% input$acctravail2 ,]
          if ( !("Tout" %in% input$autvictime2 ))
            data8 <- data8[data8$autvictime %in% input$autvictime2 ,]
          if ( !("Tout" %in% input$nbautvictime2 ))
            data8 <- data8[data8$nbautvictime %in% input$nbautvictime2 ,]
          if ( !("Tout" %in% input$desclesionsnew2 ))
            data8 <- data8[data8$desclesionsnew %in% input$desclesionsnew2 ,]
          if ( !("Tout" %in% input$pathoInterc2 ))
            data8 <- data8[data8$pathoInterc %in% input$pathoInterc2 ,]
          if ( !("Tout" %in% input$autopsie2 ))
            data8 <- data8[data8$autopsie %in% input$autopsie2 ,]
          if ( !("Tout" %in% input$leveedecorps2 ))
            data8 <- data8[data8$leveedecorps %in% input$leveedecorps2 ,]
          if ( !("Tout" %in% input$decho2 ))
            data8 <- data8[data8$decho %in% input$decho2 ,]
          if ( !("Tout" %in% input$samu2 ))
            data8 <- data8[data8$samu %in% input$samu2 ,]
          if ( !("Tout" %in% input$dcimm2 ))
            data8 <- data8[data8$dcimm %in% input$dcimm2 ,]
          if ( !("Tout" %in% input$tetra2 ))
            data8 <- data8[data8$tetra %in% input$tetra2 ,]
          if ( !("Tout" %in% input$para2 ))
            data8 <- data8[data8$para %in% input$para2 ,]
          if ( !("Tout" %in% input$comles2 ))
            data8 <- data8[data8$comles %in% input$comles2 ,]
          if ( !("Tout" %in% input$id_victi2 ))
            data8 <- data8[data8$id_victi %in% input$id_victi2 ,]
          if ( !("Tout" %in% input$tas2 ))
            data8 <- data8[data8$tas %in% input$tas2 ,]
          if ( !("Tout" %in% input$tad2 ))
            data8 <- data8[data8$tad %in% input$tad2 ,]
          if ( !("Tout" %in% input$gcs2 ))
            data8 <- data8[data8$gcs %in% input$gcs2 ,]
          if ( !("Tout" %in% input$fc2 ))
            data8 <- data8[data8$fc %in% input$fc2 ,]
          if ( !("Tout" %in% input$satO22 ))
            data8 <- data8[data8$satO2 %in% input$satO22 ,]
          if ( !("Tout" %in% input$glycemie2 ))
            data8 <- data8[data8$glycemie %in% input$glycemie2 ,]
          if ( !("Tout" %in% input$hemocue2 ))
            data8 <- data8[data8$hemocue %in% input$hemocue2 ,]
          if ( !("Tout" %in% input$temperature2 ))
            data8 <- data8[data8$temperature %in% input$temperature2 ,]
          if ( !("Tout" %in% input$commentphysio2 ))
            data8 <- data8[data8$commentphysio %in% input$commentphysio2 ,]
          if ( !("Tout" %in% input$MAISdeux ))
            data8 <- data8[data8$MAIS %in% input$MAISdeux ,]
          if ( !("Tout" %in% input$dc2 ))
            data8 <- data8[data8$dc %in% input$dc2 ,]
          if ( !("Tout" %in% input$statutdeux ))
            data8 <- data8[data8$statut %in% input$statutdeux ,]
          if ( !("Tout" %in% input$RetourDom2 ))
            data8 <- data8[data8$RetourDom %in% input$RetourDom2 ,]
          if ( !("Tout" %in% input$DevenirComplet2 ))
            data8 <- data8[data8$DevenirComplet %in% input$DevenirComplet2 ,]
          if (!("Tout" %in% input$typeFich2 ))
            data8 <- data8[data8$typeFich %in% input$typeFich2 ,]
          if ( !("Tout" %in% input$MIISdeux ))
            data8 <- data8[data8$MIIS %in% input$MIISdeux ,]
          if ( !("Tout" %in% input$nblesion2 ))
            data8 <- data8[data8$nblesion %in% input$nblesion2 ,]
          if ( !("Tout" %in% input$MAIS12 ))
            data8 <- data8[data8$MAIS1 %in% input$MAIS12 ,]
          if ( !("Tout" %in% input$MIIS12 ))
            data8 <- data8[data8$MIIS1 %in% input$MIIS12 ,]
          if ( !("Tout" %in% input$R12 ))
            data8 <- data8[data8$R1 %in% input$R12 ,]
          if ( !("Tout" %in% input$MAIS22 ))
            data8 <- data8[data8$MAIS2 %in% input$MAIS22 ,]
          if ( !("Tout" %in% input$MIIS22 ))
            data8 <- data8[data8$MIIS2 %in% input$MIIS22 ,]
          if ( !("Tout" %in% input$Rdeux2 ))
            data8 <- data8[data8$R2 %in% input$Rdeux2 ,]
          if ( !("Tout" %in% input$MAIS32 ))
            data8 <- data8[data8$MAIS3 %in% input$MAIS32 ,]
          if ( !("Tout" %in% input$MIIS32 ))
            data8 <- data8[data8$MIIS3 %in% input$MIIS32 ,]
          if ( !("Tout" %in% input$R32 ))
            data8 <- data8[data8$R3 %in% input$R32 ,]
          if ( !("Tout" %in% input$MAIS42 ))
            data8 <- data8[data8$MAIS4 %in% input$MAIS42 ,]
          if ( !("Tout" %in% input$MIIS42 ))
            data8 <- data8[data8$MIIS4 %in% input$MIIS42 ,]
          if ( !("Tout" %in% input$R42 ))
            data8 <- data8[data8$R4 %in% input$R42 ,]
          if ( !("Tout" %in% input$MAIS52 ))
            data8 <- data8[data8$MAIS5 %in% input$MAIS52 ,]
          if ( !("Tout" %in% input$MIIS52 ))
            data8 <- data8[data8$MIIS5 %in% input$MIIS52 ,]
          if ( !("Tout" %in% input$R52 ))
            data8 <- data8[data8$R5 %in% input$R52 ,]
          if ( !("Tout" %in% input$MAIS62 ))
            data8 <- data8[data8$MAIS6 %in% input$MAIS62 ,]
          if ( !("Tout" %in% input$MIIS62 ))
            data8 <- data8[data8$MIIS6 %in% input$MIIS62 ,]
          if ( !("Tout" %in% input$R62 ))
            data8 <- data8[data8$R6 %in% input$R62 ,]
          if ( !("Tout" %in% input$MAIS72 ))
            data8 <- data8[data8$MAIS7 %in% input$MAIS72 ,]
          if ( !("Tout" %in% input$MIIS72 ))
            data8 <- data8[data8$MIIS7 %in% input$MIIS72 ,]
          if ( !("Tout" %in% input$R72 ))
            data8 <- data8[data8$R7 %in% input$R72 ,]
          if ( !("Tout" %in% input$MAIS82 ))
            data8 <- data8[data8$MAIS8 %in% input$MAIS82 ,]
          if ( !("Tout" %in% input$MIIS82 ))
            data8 <- data8[data8$MIIS8 %in% input$MIIS82 ,]
          if ( !("Tout" %in% input$R82 ))
            data8 <- data8[data8$R8 %in% input$R82 ,]
          if ( !("Tout" %in% input$MAIS92 ))
            data8 <- data8[data8$MAIS9 %in% input$MAIS92 ,]
          if ( !("Tout" %in% input$MIIS92 ))
            data8 <- data8[data8$MIIS9 %in% input$MIIS92 ,]
          if ( !("Tout" %in% input$R92 ))
            data8 <- data8[data8$R9 %in% input$R92 ,]
          if ( !("Tout" %in% input$gravMAIS2 ))
            data8 <- data8[data8$gravMAIS %in% input$gravMAIS2 ,]
          if ( !("Tout" %in% input$gravMIIS2 ))
            data8 <- data8[data8$gravMIIS %in% input$gravMIIS2 ,]
          if ( !("Tout" %in% input$maisfdeux ))
            data8 <- data8[data8$maisf %in% input$maisfdeux ,]
          if ( !("Tout" %in% input$maisf12 ))
            data8 <- data8[data8$maisf1 %in% input$maisf12 ,]
          if ( !("Tout" %in% input$maisf22 ))
            data8 <- data8[data8$maisf2 %in% input$maisf22 ,]
          if ( !("Tout" %in% input$maisf32 ))
            data8 <- data8[data8$maisf3 %in% input$maisf32 ,]
          if ( !("Tout" %in% input$maisf42 ))
            data8 <- data8[data8$maisf4 %in% input$maisf42 ,]
          if ( !("Tout" %in% input$maisf52 ))
            data8 <- data8[data8$maisf5 %in% input$maisf52 ,]
          if ( !("Tout" %in% input$maisf62 ))
            data8 <- data8[data8$maisf6 %in% input$maisf62 ,]
          if ( !("Tout" %in% input$maisf72 ))
            data8 <- data8[data8$maisf7 %in% input$maisf72 ,]
          if ( !("Tout" %in% input$maisf82 ))
            data8 <- data8[data8$maisf8 %in% input$maisf82 ,]
          if ( !("Tout" %in% input$maisf92 ))
            data8 <- data8[data8$maisf9 %in% input$maisf92 ,]
          if ( !("Tout" %in% input$AgeA2 ))
            data8 <- data8[data8$AgeA %in% input$AgeA2 ,]
          if ( !("Tout" %in% input$AgeArron2 ))
            data8 <- data8[data8$AgeArron %in% input$AgeArron2 ,]
          if ( !("Tout" %in% input$AgeJ2 ))
            data8 <- data8[data8$AgeJ %in% input$AgeJ2 ,]
          if ( !("Tout" %in% input$AgeRev2 ))
            data8 <- data8[data8$AgeRev %in% input$AgeRev2 ,]
          if ( !("Tout" %in% input$iss2 ))
            data8 <- data8[data8$iss %in% input$iss2 ,]
          if ( !("Tout" %in% input$niss2 ))
            data8 <- data8[data8$niss %in% input$niss2 ,]
          if ( !("Tout" %in% input$AISCode92 ))
            data8 <- data8[data8$AISCode9 %in% input$AISCode92 ,]
          if ( !("Tout" %in% input$nbhosp2 ))
            data8 <- data8[data8$nbhosp %in% input$nbhosp2 ,]
          if ( !("Tout" %in% input$rBaac2 ))
            data8 <- data8[data8$rBaac %in% input$rBaac2 ,]
          
          
          
          
          
          
          
          if ("Tout" %in% input$num_victime2         & "Tout" %in% input$n_individu2 
              & "Tout" %in% input$jour_nais2          & "Tout" %in% input$mois_nais2 
              & "Tout" %in% input$annee_nais2        & "Tout" %in% input$sexe2 
              & "Tout" %in% input$dep_res2           & "Tout" %in% input$blesse2 
              & "Tout" %in% input$veh_elec2          & "Tout" %in% input$antagonistedeux 
              & "Tout" %in% input$antagoniste22       & "Tout" %in% input$airbag2 
              & "Tout" %in% input$ceinture2          & "Tout" %in% input$memo2 
              & "Tout" %in% input$info_pomp2         & "Tout" %in% input$info_patient2 
              & "Tout" %in% input$info_journal2      & "Tout" %in% input$info_police2 
              & "Tout" %in% input$conducteur2         & "Tout" %in% input$portcasque2 
              & "Tout" %in% input$dispositifenfant2  & "Tout" %in% input$femmeenceinte2 
              & "Tout" %in% input$poids2             & "Tout" %in% input$taille2 
              & "Tout" %in% input$acctravail2        & "Tout" %in% input$autvictime2 
              & "Tout" %in% input$nbautvictime2       & "Tout" %in% input$desclesionsnew2 
              & "Tout" %in% input$pathoInterc2       & "Tout" %in% input$autopsie2 
              & "Tout" %in% input$leveedecorps2      & "Tout" %in% input$decho2 
              & "Tout" %in% input$samu2              & "Tout" %in% input$dcimm2 
              & "Tout" %in% input$tetra2              & "Tout" %in% input$para2 
              & "Tout" %in% input$comles2            & "Tout" %in% input$id_victi2 
              & "Tout" %in% input$tas2               & "Tout" %in% input$tad2 
              & "Tout" %in% input$gcs2               & "Tout" %in% input$fc2 
              & "Tout" %in% input$satO22              & "Tout" %in% input$glycemie2 
              & "Tout" %in% input$hemocue2           & "Tout" %in% input$temperature2 
              & "Tout" %in% input$commentphysio2     & "Tout" %in% input$MAISdeux 
              & "Tout" %in% input$dc2                & "Tout" %in% input$statutdeux 
              & "Tout" %in% input$RetourDom2         & "Tout" %in% input$DevenirComplet2 
              & "Tout" %in% input$typeFich2          & "Tout" %in% input$MIISdeux 
              & "Tout" %in% input$nblesion2          & "Tout" %in% input$MAIS12 
              & "Tout" %in% input$MIIS12              & "Tout" %in% input$R12 
              & "Tout" %in% input$MAIS22             & "Tout" %in% input$MIIS22 
              & "Tout" %in% input$Rdeux2                & "Tout" %in% input$MAIS32 
              & "Tout" %in% input$MIIS32             & "Tout" %in% input$R32 
              & "Tout" %in% input$MAIS42              & "Tout" %in% input$MIIS42 
              & "Tout" %in% input$R42                & "Tout" %in% input$MAIS52 
              & "Tout" %in% input$MIIS52             & "Tout" %in% input$R52 
              & "Tout" %in% input$MAIS62             & "Tout" %in% input$MIIS62 
              & "Tout" %in% input$R62                 & "Tout" %in% input$MAIS72 
              & "Tout" %in% input$MIIS72             & "Tout" %in% input$R72 
              & "Tout" %in% input$MAIS82             & "Tout" %in% input$MIIS82 
              & "Tout" %in% input$R82                & "Tout" %in% input$MAIS92 
              & "Tout" %in% input$MIIS92              & "Tout" %in% input$R92 
              & "Tout" %in% input$gravMAIS2          & "Tout" %in% input$gravMIIS2 
              & "Tout" %in% input$maisfdeux          & "Tout" %in% input$maisf12 
              & "Tout" %in% input$maisf22            & "Tout" %in% input$maisf32 
              & "Tout" %in% input$maisf42             & "Tout" %in% input$maisf52 
              & "Tout" %in% input$maisf62            & "Tout" %in% input$maisf72 
              & "Tout" %in% input$maisf82            & "Tout" %in% input$maisf92 
              & "Tout" %in% input$AgeA2              & "Tout" %in% input$AgeArron2 
              & "Tout" %in% input$AgeJ2              & "Tout" %in% input$AgeRev2 
              & "Tout" %in% input$iss2                & "Tout" %in% input$niss2 
              & "Tout" %in% input$AISCode92          & "Tout" %in% input$nbhosp2 
              & "Tout" %in% input$rBaac2 
          ) {
            
            if ("Aucun" %in% input$num_victime         & "Aucun" %in% input$n_individu 
                & "Aucun" %in% input$jour_nais          & "Aucun" %in% input$mois_nais 
                & "Aucun" %in% input$annee_nais        & "Aucun" %in% input$sexe 
                & "Aucun" %in% input$dep_res           & "Aucun" %in% input$blesse 
                & "Aucun" %in% input$veh_elec          & "Aucun" %in% input$antagoniste 
                & "Aucun" %in% input$antagoniste2       & "Aucun" %in% input$airbag 
                & "Aucun" %in% input$ceinture          & "Aucun" %in% input$memo 
                & "Aucun" %in% input$info_pomp         & "Aucun" %in% input$info_patient 
                & "Aucun" %in% input$info_journal      & "Aucun" %in% input$info_police 
                & "Aucun" %in% input$conducteur         & "Aucun" %in% input$portcasque 
                & "Aucun" %in% input$dispositifenfant  & "Aucun" %in% input$femmeenceinte 
                & "Aucun" %in% input$poids             & "Aucun" %in% input$taille 
                & "Aucun" %in% input$acctravail        & "Aucun" %in% input$autvictime 
                & "Aucun" %in% input$nbautvictime       & "Aucun" %in% input$desclesionsnew 
                & "Aucun" %in% input$pathoInterc       & "Aucun" %in% input$autopsie 
                & "Aucun" %in% input$leveedecorps      & "Aucun" %in% input$decho 
                & "Aucun" %in% input$samu              & "Aucun" %in% input$dcimm 
                & "Aucun" %in% input$tetra              & "Aucun" %in% input$para 
                & "Aucun" %in% input$comles            & "Aucun" %in% input$id_victi 
                & "Aucun" %in% input$tas               & "Aucun" %in% input$tad 
                & "Aucun" %in% input$gcs               & "Aucun" %in% input$fc 
                & "Aucun" %in% input$satO2              & "Aucun" %in% input$glycemie 
                & "Aucun" %in% input$hemocue           & "Aucun" %in% input$temperature 
                & "Aucun" %in% input$commentphysio     & "Aucun" %in% input$MAIS 
                & "Aucun" %in% input$dc                & "Aucun" %in% input$statut 
                & "Aucun" %in% input$RetourDom         & "Aucun" %in% input$DevenirComplet 
                & "Aucun" %in% input$typeFich          & "Aucun" %in% input$MIIS 
                & "Aucun" %in% input$nblesion          & "Aucun" %in% input$MAIS1 
                & "Aucun" %in% input$MIIS1              & "Aucun" %in% input$R1 
                & "Aucun" %in% input$MAIS2             & "Aucun" %in% input$MIIS2 
                & "Aucun" %in% input$Rdeux                & "Aucun" %in% input$MAIS3 
                & "Aucun" %in% input$MIIS3             & "Aucun" %in% input$R3 
                & "Aucun" %in% input$MAIS4              & "Aucun" %in% input$MIIS4 
                & "Aucun" %in% input$R4                & "Aucun" %in% input$MAIS5 
                & "Aucun" %in% input$MIIS5             & "Aucun" %in% input$R5 
                & "Aucun" %in% input$MAIS6             & "Aucun" %in% input$MIIS6 
                & "Aucun" %in% input$R6                 & "Aucun" %in% input$MAIS7 
                & "Aucun" %in% input$MIIS7             & "Aucun" %in% input$R7 
                & "Aucun" %in% input$MAIS8             & "Aucun" %in% input$MIIS8 
                & "Aucun" %in% input$R8                & "Aucun" %in% input$MAIS9 
                & "Aucun" %in% input$MIIS9              & "Aucun" %in% input$R9 
                & "Aucun" %in% input$gravMAIS          & "Aucun" %in% input$gravMIIS 
                & "Aucun" %in% input$maisf             & "Aucun" %in% input$maisf1 
                & "Aucun" %in% input$maisf2            & "Aucun" %in% input$maisf3 
                & "Aucun" %in% input$maisf4             & "Aucun" %in% input$maisf5 
                & "Aucun" %in% input$maisf6            & "Aucun" %in% input$maisf7 
                & "Aucun" %in% input$maisf8            & "Aucun" %in% input$maisf9 
                & "Aucun" %in% input$AgeA              & "Aucun" %in% input$AgeArron 
                & "Aucun" %in% input$AgeJ              & "Aucun" %in% input$AgeRev 
                & "Aucun" %in% input$iss                & "Aucun" %in% input$niss 
                & "Aucun" %in% input$AISCode9          & "Aucun" %in% input$nbhosp 
                & "Aucun" %in% input$rBaac 
            )
            DATA4=victime
            
            else(DATA4=data7)
          }
          
          else(DATA4=merge(data7,data8,by=names(victime),all=T))
        })
        
        
        
        
        
        DATA1=DATA1[(DATA1$n_accident %in% DATA4$n_accident),]
        DATA3=DATA3[(DATA3$id_victi %in% DATA4$id_victi),]
        DATA2=DATA2[(DATA2$id_victi %in% DATA4$id_victi),]
        DATA4tempo1=DATA4[(DATA4$statut==1),]
        DATA4tempo2=DATA4[(DATA4$statut==2),]
        
        DATA4=DATA4[(DATA4$n_accident %in% DATA1$n_accident),]
        DATA4=DATA4[DATA4$id_victi %in% DATA3$id_victi,]
        DATA4=DATA4[DATA4$id_victi %in% DATA2$id_victi,]
        
        
        input$sélectionButton
        isolate({
          if(input$statut1>0){
            DATA4=merge(DATA4,DATA4tempo1,names(victime),all=T)
          }
          if(input$statut2>0){
            DATA4=merge(DATA4,DATA4tempo2,names(victime),all=T)
            
          }
        })
        
        
        DATA1=DATA1[(DATA1$n_accident %in% DATA4$n_accident),]
        DATA3=DATA3[(DATA3$id_victi %in% DATA4$id_victi),]
        DATA2=DATA2[(DATA2$id_victi %in% DATA4$id_victi),]
        
        
        #####################################################################################################################################################################
        
        
        fusion=merge(DATA4,DATA1,"n_accident")
        observe({
          if (input$downloadDatafusion){
            isolate({
              if("Aucun" %in% input$k){
                tabfusion=table(fusion[,input$j])
              }
              
              else if("Aucun" %in% input$j){
                tabfusion=table(fusion[,input$k])
              }
              
              
              else{
                tabfusion=table(fusion[,c(input$j,input$k)])
                if(input$retirerNA>0){
                  if("" %in% colnames(tabfusion))
                    tabfusion=tabfusion[,-1]
                  if("" %in% rownames(tabfusion))
                    tabfusion=tabfusion[-1,]
                  for(i in 1:ncol(tabfusion)){
                    if(sum(tabfusion[,i])==0){
                      tabfusion[,i]=NA
                    }
                  }
                  
                  
                  tabfusion=tabfusion[, apply(tabfusion,2, function(x) !all(is.na(x)))]
                }
                
                if(input$voirsum>0){
                  tabfusion=addmargins(tabfusion)
                }
                
                if(input$voirsum>0){
                  tabfusion=addmargins(tabfusion)
                }
                if(input$pourcentageligne>0){
                  tabfusion=prop.table(tabfusion,1)
                }
                if(input$pourcentagecolonne>0){
                  tabfusion=prop.table(tabfusion,2)
                }
                
              }
              
              
              
              fname <- paste0("victime_accident", Sys.Date(),'.csv')
              write.table(tabfusion,fname,sep=";",col.names=NA)
              
            })
          }
        })
        output$crosstablefusion <- renderPrint({
          if("Aucun" %in% input$k){
            tabfusion=table(fusion[,input$j])
          }
          
          else if("Aucun" %in% input$j){
            tabfusion=table(fusion[,input$k])
          }
          
          else{
            tabfusion=table(fusion[,c(input$j,input$k)])
            if(input$retirerNA>0){
              if("" %in% colnames(tabfusion))
                tabfusion=tabfusion[,-1]
              if("" %in% rownames(tabfusion))
                tabfusion=tabfusion[-1,]
              for(i in 1:ncol(tabfusion)){
                if(sum(tabfusion[,i])==0){
                  tabfusion[,i]=NA
                }
              }
              tabfusion=tabfusion[, apply(tabfusion, 2, function(x) !all(is.na(x)))]
              
              
              
            }
            if(input$voirsum>0){
              tabfusion=addmargins(tabfusion)
            }
            if(input$pourcentageligne>0){
              tabfusion=prop.table(tabfusion,1)
            }
            if(input$pourcentagecolonne>0){
              tabfusion=prop.table(tabfusion,2)
            }
            
          }
          tabfusion
        })
        
        
        
        input$tableMAIS
        isolate({
          MAIS1=table(victime[,"MAIS1"])
          MAIS2=table(victime[,"MAIS2"])
          MAIS3=table(victime[,"MAIS3"])
          MAIS4=table(victime[,"MAIS4"])
          MAIS5=table(victime[,"MAIS5"])
          MAIS6=table(victime[,"MAIS6"])
          MAIS7=table(victime[,"MAIS7"])
          MAIS8=table(victime[,"MAIS8"])
          MAIS9=table(victime[,"MAIS9"])
          MAIS=smartbind(MAIS1,MAIS2,MAIS3,MAIS4,MAIS5,MAIS6,MAIS7,MAIS8,MAIS9)
          rownames(MAIS)=c("MAIS1","MAIS2","MAIS3","MAIS4","MAIS5","MAIS6","MAIS7","MAIS8","MAIS9")
          
          
        })
        input$tableMIIS
        isolate({
          MIIS1=table(victime[,"MIIS1"])
          MIIS2=table(victime[,"MIIS2"])
          MIIS3=table(victime[,"MIIS3"])
          MIIS4=table(victime[,"MIIS4"])
          MIIS5=table(victime[,"MIIS5"])
          MIIS6=table(victime[,"MIIS6"])
          MIIS7=table(victime[,"MIIS7"])
          MIIS8=table(victime[,"MIIS8"])
          MIIS9=table(victime[,"MIIS9"])
          MIIS=smartbind(MIIS1,MIIS2,MIIS3,MIIS4,MIIS5,MIIS6,MIIS7,MIIS8,MIIS9)  
          rownames(MIIS)=c("MIIS1","MIIS2","MIIS3","MIIS4","MIIS5","MIIS6","MIIS7","MIIS8","MIIS9")
        })
        
        
        
        
        observe({
          
          if (input$tableMAIS>0){
            fname <- paste0('MAIS', Sys.Date(),'.csv')
            write.table(MAIS,fname,sep=";",col.names=NA)
            
          }
        })
        observe({
          
          if (input$tableMIIS>0){
            fname <- paste0('MIIS', Sys.Date(),'.csv')
            write.table(MIIS,fname,sep=";",col.names=NA)
            
          }
        })
        output$down1 <- downloadHandler(
          filename =  function() {
            paste("plot_accident", "pdf", sep=".")
          },
          content = function(file) {
            
            pdf(file)
            plot(DATA1[,input$aa],xlab=input$aa)
            dev.off() 
            
          }
        )
        
        observe({
          if (input$downloadDatatab1){
            isolate({
              if("Aucun" %in% input$b){
                table1=table(DATA1[,input$a])
              }
              else if("Aucun" %in% input$a){
                table1=table(DATA1[,input$b])
              }
              else{
                table1=table(DATA1[,c(input$a,input$b)])
                
                if(input$retirerNA1>0){
                  if("" %in% colnames(table1))
                    table1=table1[,-1]
                  if("" %in% rownames(table1))
                    table1=table1[-1,]
                  for(i in 1:ncol(table1)){
                    if(sum(table1[,i])==0){
                      table1[,i]=NA
                    }
                  }
                  table1=table1[, apply(table1, 2, function(x) !all(is.na(x)))]
                  
                  
                  
                }
                if(input$voirsum1>0){
                  table1=addmargins(table1)
                }
                if(input$pourcentageligne1>0){
                  table1=prop.table(table1,1)
                }
                if(input$pourcentagecolonne1>0){
                  table1=prop.table(table1,2)
                }
                
              }
              
              
              
              fname <- paste0("table croisée accident", Sys.Date(),'.csv')
              write.table(table1,fname,sep=";",col.names=NA)
              
            })
          }
        })
        
        output$crosstable1 <- renderPrint({
          if("Aucun" %in% input$b){
            table1=table(DATA1[,input$a])
          }
          else if("Aucun" %in% input$a){
            table1=table(DATA1[,input$b])
          }
          else{
            table1=table(DATA1[,c(input$a,input$b)])
            
            if(input$retirerNA1>0){
              if("" %in% colnames(table1))
                table1=table1[,-1]
              if("" %in% rownames(table1))
                table1=table1[-1,]
              for(i in 1:ncol(table1)){
                if(sum(table1[,i])==0){
                  table1[,i]=NA
                }
              }
              table1=table1[, apply(table1, 2, function(x) !all(is.na(x)))]
              
              
              
            }
            if(input$voirsum1>0){
              table1=addmargins(table1)
            }
            if(input$pourcentageligne1>0){
              table1=prop.table(table1,1)
            }
            if(input$pourcentagecolonne1>0){
              table1=prop.table(table1,2)
            }
            
          }
          table1
        })
        
        
        
        plot1 <- eventReactive(input$goButton1, {
          
          plot(DATA1[,input$aa],xlab=input$aa)
          
          
          
        })
        output$plot1=renderPlot({
          plot1()
        })
        pie1 <- eventReactive(input$pieButton1, {
          
          pie(table(DATA1[,input$aa]),xlab=input$aa)
          
          
          
        })
        output$pie1=renderPlot({
          pie1()
        })
        
        output$piedown1 <- downloadHandler(
          filename =  function() {
            paste("pie_accident", "pdf", sep=".")
          },
          content = function(file) {
            
            pdf(file)
            pie(table(DATA1[,input$aa]),xlab=input$aa)
            dev.off() 
            
          }
        )
        
        
        
        input$SélectionButton
        isolate({
          if(!("Tout" %in% input$colonnefiche)){
            DATA3 <- DATA3[,input$colonnefiche,drop=F]
          }
        })
        
        observe({
          
          if (input$downloadDatatab3){
            isolate({
              if("Aucun" %in% input$f){
                table3=table(DATA3[,input$e])
              }
              else if("Aucun" %in% input$e){
                table3=table(DATA3[,input$f])
              }
              else{
                table3=table(DATA3[,c(input$e,input$f)])
                
                if(input$retirerNA3>0){
                  if("" %in% colnames(table3))
                    table3=table3[,-1]
                  if("" %in% rownames(table3))
                    table3=table3[-1,]
                  for(i in 1:ncol(table3)){
                    if(sum(table3[,i])==0){
                      table3[,i]=NA
                    }
                  }
                  table3=table3[, apply(table3, 2, function(x) !all(is.na(x)))]
                  
                  
                  
                }
                if(input$voirsum3>0){
                  table3=addmargins(table3)
                }
                if(input$pourcentageligne3>0){
                  table3=prop.table(table3,1)
                }
                if(input$pourcentagecolonne3>0){
                  table3=prop.table(table3,2)
                }
                
              }
              
              
              fname <- paste0('table croisée fiche', Sys.Date(),'.csv')
              write.table(table3,fname,sep=";",col.names=NA)
              
            })
          }
        })
        
        output$crosstable3 <- renderPrint({
          if("Aucun" %in% input$f){
            table3=table(DATA3[,input$e])
          }
          else if("Aucun" %in% input$e){
            table3=table(DATA3[,input$f])
          }
          else{
            table3=table(DATA3[,c(input$e,input$f)])
            
            if(input$retirerNA1>0){
              if("" %in% colnames(table3))
                table3=table3[,-1]
              if("" %in% rownames(table3))
                table3=table3[-1,]
              for(i in 1:ncol(table3)){
                if(sum(table3[,i])==0){
                  table3[,i]=NA
                }
              }
              table3=table3[, apply(table3, 2, function(x) !all(is.na(x)))]
              
              
              
            }
            if(input$voirsum3>0){
              table3=addmargins(table3)
            }
            if(input$pourcentageligne3>0){
              table3=prop.table(table3,1)
            }
            if(input$pourcentagecolonne3>0){
              table3=prop.table(table3,2)
            }
            table3
          }
        })
        
        
        
        output$down3 <- downloadHandler(
          filename =  function() {
            paste("plot_fiche", "pdf", sep=".")
          },
          content = function(file) {
            
            pdf(file)
            plot(DATA3[,input$ac],xlab=input$ac)
            dev.off() 
            
          }
        )
        plot3 <- eventReactive(input$goButton3, {
          
          plot(DATA3[,input$ac],xlab=input$ac)
          
          
          
        })
        output$plot3=renderPlot({
          plot3()
        })
        
        pie3 <- eventReactive(input$piebutton3, {
          
          pie(table(DATA3[,input$ac]),xlab=input$ac)
          
          
          
        })
        output$pie3=renderPlot({
          
          pie3()
        })
        output$piedown3 <- downloadHandler(
          filename =  function() {
            paste("pie_fiche", "pdf", sep=".")
          },
          content = function(file) {
            
            pdf(file)
            pie(table(DATA3[,input$ac]),xlab=input$ac)
            dev.off() 
            
          }
        )
        
        input$SélectionButton
        isolate({
          if(!("Tout" %in% input$colonnelesion)){
            DATA2 <- DATA2[,input$colonnelesion,drop=F]
          }
        })
        
        
        
        
        
        output$down2 <- downloadHandler(
          filename =  function() {
            paste("plot_lesion", "pdf", sep=".")
          },
          content = function(file) {
            
            pdf(file)
            plot(DATA2[,input$ab],xlab=input$ab)
            dev.off() 
            
          }
        )
        
        observe({
          if (input$downloadDatatab2){
            isolate({
              
              if("Aucun" %in% input$d){
                table2=table(DATA2[,input$c])
              }
              else if("Aucun" %in% input$c){
                table2=table(DATA2[,input$d])
              }
              else{
                table2=table(DATA2[,c(input$c,input$d)])
                
                if(input$retirerNA2>0){
                  if("" %in% colnames(table2))
                    table2=table2[,-1]
                  if("" %in% rownames(table2))
                    table2=table2[-1,]
                  for(i in 1:ncol(table2)){
                    if(sum(table2[,i])==0){
                      table2[,i]=NA
                    }
                  }
                  table2=table2[, apply(table2, 2, function(x) !all(is.na(x)))]
                  
                  
                  
                }
                if(input$voirsum2>0){
                  table2=addmargins(table2)
                }
                if(input$pourcentageligne2>0){
                  table2=prop.table(table2,1)
                }
                if(input$pourcentagecolonne2>0){
                  table2=prop.table(table2,2)
                }
                
              }
              
              
              fname <- paste0('table croisée lesions', Sys.Date(),'.csv')
              write.table(table2,fname,sep=";",col.names=NA)
              
            })
          }
        })
        output$crosstable2 <- renderPrint({
          if("Aucun" %in% input$d){
            table2=table(DATA2[,input$c])
          }
          else if("Aucun" %in% input$c){
            table2=table(DATA2[,input$d])
          }
          else{
            table2=table(DATA2[,c(input$c,input$d)])
            
            if(input$retirerNA2>0){
              if("" %in% colnames(table2))
                table2=table2[,-1]
              if("" %in% rownames(table2))
                table2=table2[-1,]
              for(i in 1:ncol(table2)){
                if(sum(table2[,i])==0){
                  table2[,i]=NA
                }
              }
              table2=table2[, apply(table2, 2, function(x) !all(is.na(x)))]
              
              
              
            }
            if(input$voirsum2>0){
              table2=addmargins(table2)
            }
            if(input$pourcentageligne2>0){
              table2=prop.table(table2,1)
            }
            if(input$pourcentagecolonne2>0){
              table2=prop.table(table2,2)
            }
            
          }
          table2
        })
        
        
        
        
        plot2 <- eventReactive(input$goButton2, {
          
          plot(DATA2[,input$ab],xlab=input$ab)
          
          
          
        })
        output$plot2=renderPlot({
          plot2()
        })
        pie2 <- eventReactive(input$pieButton2, {
          
          pie(table(DATA2[,input$ab]),xlab=input$ab)
          
          
          
        })
        output$pie2=renderPlot({
          pie2()
        })
        output$piedown2 <- downloadHandler(
          filename =  function() {
            paste("pie_lesion", "pdf", sep=".")
          },
          content = function(file) {
            
            pdf(file)
            pie(table(DATA2[,input$ab]),xlab=input$ab)
            dev.off() 
            
          }
        )
        
        
        input$SélectionButton
        isolate({
          if(!("Tout" %in% input$colonnevictime)){
            DATA4 <- DATA4[,input$colonnevictime,drop=F]
          }
        })
        
        
        output$down4 <- downloadHandler(
          filename =  function() {
            paste("plot_victime", "pdf", sep=".")
          },
          content = function(file) {
            
            pdf(file)
            plot(DATA4[,input$ad],xlab=input$ad)
            dev.off()
            
          }
        )
        
        observe({
          
          if (input$downloadDatatab4){
            isolate({
              if("Aucun" %in% input$h){
                table4=table(DATA4[,input$g])
              }
              else if("Aucun" %in% input$g){
                table4=table(DATA4[,input$h])
              }
              else{
                table4=table(DATA4[,c(input$g,input$h)])
                
                if(input$retirerNA4>0){
                  if("" %in% colnames(table4))
                    table4=table4[,-1]
                  if("" %in% rownames(table4))
                    table4=table4[-1,]
                  for(i in 1:ncol(table4)){
                    if(sum(table4[,i])==0){
                      table4[,i]=NA
                    }
                  }
                  table4=table4[, apply(table4, 2, function(x) !all(is.na(x)))]
                  
                  
                  
                }
                if(input$voirsum4>0){
                  table4=addmargins(table4)
                }
                if(input$pourcentageligne4>0){
                  table4=prop.table(table4,1)
                }
                if(input$pourcentagecolonne4>0){
                  table4=prop.table(table4,2)
                }
                
              }
              
              
              fname <- paste0('table croisée victime', Sys.Date(),'.csv')
              write.table(table4,fname,sep=";",col.names=NA)
              
            })
          }
        })
        
        output$crosstable4 <- renderPrint({
          if("Aucun" %in% input$h){
            table4=table(DATA4[,input$g])
          }
          else if("Aucun" %in% input$g){
            table4=table(DATA4[,input$h])
          }
          else{
            table4=table(DATA4[,c(input$g,input$h)])
            
            if(input$retirerNA4>0){
              if("" %in% colnames(table4))
                table4=table4[,-1]
              if("" %in% rownames(table4))
                table4=table4[-1,]
              for(i in 1:ncol(table4)){
                if(sum(table4[,i])==0){
                  table4[,i]=NA
                }
              }
              table4=table4[, apply(table4, 2, function(x) !all(is.na(x)))]
              
              
              
            }
            if(input$voirsum4>0){
              table4=addmargins(table4)
            }
            if(input$pourcentageligne4>0){
              table4=prop.table(table4,1)
            }
            if(input$pourcentagecolonne4>0){
              table4=prop.table(table4,2)
            }
            
          }
          table4
        })
        
        
        
        plot4 <- eventReactive(input$goButton4, {
          
          plot(DATA4[,input$ad],xlab=input$ad)
          
          
          
        })
        output$plot4=renderPlot({
          plot4()
        })
        pie4 <- eventReactive(input$pieButton4, {
          
          pie(table(DATA4[,input$ad]),xlab=input$ad)
          
          
          
        })
        output$pie4=renderPlot({
          pie4()
        })
        output$piedown4 <- downloadHandler(
          filename =  function() {
            paste("pie_victime", "pdf", sep=".")
          },
          content = function(file) {
            
            pdf(file)
            pie(table(DATA4[,input$ad]),xlab=input$ad)
            dev.off() 
            
          }
        )
        
        
        
        save1=DATA1
        save2=DATA2
        save3=DATA3
        save4=DATA4
        
        data <- switch(input$data,
                       accident = save1,
                       lesions = save2,
                       fiche = save3,
                       victime = save4 )
        
        
        observe({
          if (input$downloadData>0){
            fname <- paste0(input$data, Sys.Date(),'.csv')
            write.table(data,fname,sep=";",col.names=NA)
            
          }
        })
        
        data
        
        
      }))
      ################################################
      output$mytable1 <- DT::renderDataTable(DT::datatable({
        
        
      }))
      output$mytable3 <- DT::renderDataTable(DT::datatable({
        
        
      }))
      output$mytable4 <- DT::renderDataTable(DT::datatable({
        data1=codeais
        data2=codeais
        input$SélectionButtoncode
        isolate({
          if (!( "Tout" %in% input$NUMERO )
              & !( "Tout" %in% input$Rcode )
              & !( "Tout" %in% input$Tcode )
              & !( "Tout" %in% input$Scode )
              & !( "Tout" %in% input$Ncode )
              & !( "Tout" %in% input$AIScode )
              & !( "Tout" %in% input$IIScode )
              & !( "Tout" %in% input$DescrRcode )
              & !( "Tout" %in% input$DescrTcode )
              & !( "Tout" %in% input$DescrScode )
              & !( "Tout" %in% input$DescrNcode )
              
              
          )
          
          {
            data1 <- data1[
              data1$NUMERO %in% input$NUMERO
              | data1$R %in% input$Rcode
              | data1$T %in% input$Tcode
              | data1$S %in% input$Scode
              | data1$N %in% input$Ncode
              | data1$AIS %in% input$AIScode
              | data1$IIS %in% input$IIScode
              | data1$DescrR %in% input$DescrRcode
              | data1$DescrT %in% input$DescrTcode
              | data1$DescrS %in% input$DescrScode
              | data1$DescrN %in% input$DescrNcode
              
              ,]
            
            
          }
          if (!( "Tout" %in% input$NUMERO2 ))
            data2 <- data2[data2$NUMERO %in% input$NUMERO2 ,]
          
          if (!( "Tout" %in% input$Rcode2 ))
            data2 <- data2[data2$R %in% input$Rcode2 ,]
          
          if (!( "Tout" %in% input$Tcode2  ))
            data2 <- data2[data2$T %in% input$Tcode2 ,]
          
          if (!( "Tout" %in% input$Scode2 ))
            data2 <- data2[data2$S %in% input$Scode2 ,]
          
          if (!( "Tout" %in% input$Ncode2 ))
            data2 <- data2[data2$N %in% input$Ncode2 ,]
          
          if (!( "Tout" %in% input$AIScode2 ))
            data2 <- data2[data2$AIS %in% input$AIScode2 ,]
          
          if (!( "Tout" %in% input$IIScode2 ))
            data2 <- data2[data2$IIS %in% input$IIScode2 ,]
          
          if (!( "Tout" %in% input$DescrRcode2 ))
            data2 <- data2[data2$DescrR %in% input$DescrRcode2 ,]
          
          if (!( "Tout" %in% input$DescrTcode2 ))
            data2 <- data2[data2$DescrT %in% input$DescrTcode2 ,]
          
          if (!( "Tout" %in% input$DescrScode2 ))
            data2 <- data2[data2$DescrS %in% input$DescrScode2 ,]
          
          if (!( "Tout" %in% input$DescrNcode2 ))
            data2 <- data2[data2$DescrN %in% input$DescrNcode2 ,]
          
          
          
          
          
          
          
          
          if ( "Tout" %in% input$NUMERO2  &  "Tout" %in% input$Rcode2 &
               "Tout" %in% input$Tcode2  & "Tout" %in% input$Scode2  &
               "Tout" %in% input$Ncode2 & "Tout" %in% input$AIScode2 &  "Tout" %in% input$IIScode2  &  "Tout" %in% input$DescrRcode2  &
               "Tout" %in% input$DescrTcode2  &  "Tout" %in% input$DescrScode2  &  "Tout" %in% input$DescrNcode2 ) {
            
            if ( "Aucun" %in% input$NUMERO  &  "Aucun" %in% input$Rcode &
                 "Aucun" %in% input$Tcode  & "Aucun" %in% input$Scode  &
                 "Aucun" %in% input$Ncode & "Aucun" %in% input$AIScode &  "Aucun" %in% input$IIScode  &  "Aucun" %in% input$DescrRcode  &
                 "Aucun" %in% input$DescrTcode  &  "Aucun" %in% input$DescrScode  &  "Aucun" %in% input$DescrNcode ) 
              DATA=codeais
            
            else(DATA=data1)
          }
          
          else(DATA=merge(data1,data2,by=names(codeais),all=T))
        }) 
        DATA
        
      }))
      
    })
  )
}

IRVAC()
